{"remainingRequest":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js!/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangrong/workspace/apitest/apitest-web/src/views/project/projectConfig.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangrong/workspace/apitest/apitest-web/src/views/project/projectConfig.vue","mtime":1588821037198},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//import NProgress from 'nprogress'\nimport { test } from \"../../api/api\";\nimport axios from 'axios';\nexport default {\n  data: function data() {\n    return {\n      type: [{\n        value: 'env',\n        label: '环境'\n      }, {\n        value: 'data',\n        label: '数据'\n      }, {\n        value: 'config',\n        label: '配置'\n      }],\n      filters: {\n        name: ''\n      },\n      project: [],\n      total: 0,\n      page: 1,\n      pages: 0,\n      listLoading: false,\n      sels: [],\n      //列表选中列\n      editForm: {\n        //编辑界面数据\n        data: {\n          id: '',\n          name: '',\n          type: 'env',\n          value: '',\n          description: ''\n        },\n        title: \"\",\n        visible: false,\n        //编辑界面是否显示\n        loading: false,\n        rules: {\n          name: [{\n            required: true,\n            message: '请输入名称',\n            trigger: 'blur'\n          }, {\n            min: 1,\n            max: 50,\n            message: '长度在 1 到 50 个字符',\n            trigger: 'blur'\n          }],\n          type: [{\n            required: true,\n            message: '请选择类型',\n            trigger: 'blur'\n          }],\n          value: [{\n            required: true,\n            message: '请输入值',\n            trigger: 'blur'\n          }],\n          description: [{\n            required: false,\n            message: '请输入描述',\n            trigger: 'blur'\n          }, {\n            max: 1024,\n            message: '不能超过1024个字符',\n            trigger: 'blur'\n          }]\n        }\n      }\n    };\n  },\n  methods: {\n    // IP格式验证\n    isValidIP: function isValidIP(ip) {\n      var reg = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])$/;\n      var regPort = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5]):([0-9]|[1-9]\\d|[1-9]\\d{2}|[1-9]\\d{3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])$$/;\n      return regPort.test(ip) || reg.test(ip);\n    },\n    handleSearch: function handleSearch() {\n      this.page = 1;\n      this.getProjectConfig();\n    },\n    // 获取HOST列表\n    getProjectConfig: function getProjectConfig() {\n      this.listLoading = true;\n      var self = this;\n      var params = {\n        project_id: this.$route.params.project_id,\n        page: self.page,\n        name: self.filters.name,\n        type: self.filters.type\n      };\n      var headers = {\n        Authorization: 'Token ' + sessionStorage.getItem('token')\n      };\n      axios.get(\"\".concat(test, \"/api/project/config_list\"), {\n        params: params,\n        headers: headers\n      }).then(function (res) {\n        var _res$data = res.data,\n            msg = _res$data.msg,\n            code = _res$data.code,\n            data = _res$data.data;\n        self.listLoading = false;\n\n        if (code === '999999') {\n          self.total = data.total;\n          self.project = data.data;\n          self.pages = data.pages;\n        } else {\n          self.$message.error({\n            message: msg,\n            center: true\n          });\n        }\n      });\n    },\n    //删除\n    handleDel: function handleDel(index, row) {\n      var _this = this;\n\n      this.$confirm('确认删除配置[' + row.name + ']吗?', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this.listLoading = true; //NProgress.start();\n\n        var self = _this;\n        var params = {\n          project_id: Number(_this.$route.params.project_id),\n          ids: [row.id]\n        };\n        var headers = {\n          \"Content-Type\": \"application/json\",\n          Authorization: 'Token ' + sessionStorage.getItem('token')\n        };\n        axios.post(\"\".concat(test, \"/api/project/del_config\"), params, {\n          headers: headers\n        }).then(function (res) {\n          self.listLoading = false;\n          var _res$data2 = res.data,\n              msg = _res$data2.msg,\n              code = _res$data2.code,\n              data = _res$data2.data;\n\n          if (code === '999999') {\n            self.$message({\n              message: '删除成功',\n              center: true,\n              type: 'success'\n            });\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n\n          self.getProjectConfig();\n        });\n      }).catch(function () {});\n    },\n    handleChangeStatus: function handleChangeStatus(index, row) {\n      var self = this;\n      this.listLoading = true;\n      var params = {\n        project_id: Number(this.$route.params.project_id),\n        config_id: Number(row.id)\n      };\n      var headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: 'Token ' + sessionStorage.getItem('token')\n      };\n\n      if (row.status) {\n        axios.post(\"\".concat(test, \"/api/project/disable_config\"), params, {\n          headers: headers\n        }).then(function (res) {\n          var _res$data3 = res.data,\n              msg = _res$data3.msg,\n              code = _res$data3.code,\n              data = _res$data3.data;\n          self.listLoading = false;\n\n          if (code === '999999') {\n            self.$message({\n              message: '禁用成功',\n              center: true,\n              type: 'success'\n            });\n            row.status = !row.status;\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n        });\n      } else {\n        axios.post(\"\".concat(test, \"/api/project/enable_config\"), params, {\n          headers: headers\n        }).then(function (res) {\n          var _res$data4 = res.data,\n              msg = _res$data4.msg,\n              code = _res$data4.code,\n              data = _res$data4.data;\n          self.listLoading = false;\n\n          if (code === '999999') {\n            self.$message({\n              message: '启用成功',\n              center: true,\n              type: 'success'\n            });\n            row.status = !row.status;\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n        });\n      }\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.page = val;\n      this.getProjectConfig();\n    },\n    //显示编辑界面\n    handleEdit: function handleEdit(index, row) {\n      this.editForm.title = \"编辑\";\n      this.editForm.visible = true;\n      this.editForm.data = Object.assign({}, row);\n    },\n    //显示新增界面\n    handleAdd: function handleAdd() {\n      this.editForm.title = \"新增\";\n      this.editForm.visible = true;\n      this.editForm.data = {\n        id: '',\n        name: '',\n        type: 'env',\n        value: '',\n        description: ''\n      };\n    },\n    //编辑\n    editSubmit: function editSubmit() {\n      var _this2 = this;\n\n      var self = this;\n      this.$refs.editForm.validate(function (valid) {\n        if (valid) {\n          _this2.$confirm('确认提交吗？', '提示', {}).then(function () {\n            self.editForm.loading = true; //NProgress.start();\n\n            var params = {\n              project_id: Number(_this2.$route.params.project_id),\n              name: self.editForm.data.name,\n              type: self.editForm.data.type,\n              value: self.editForm.data.value,\n              description: self.editForm.data.description\n            };\n            var url = \"\".concat(test, \"/api/project/add_config\");\n\n            if (self.editForm.data.id != \"\") {\n              url = \"\".concat(test, \"/api/project/update_config\");\n              params[\"id\"] = Number(self.editForm.data.id);\n            }\n\n            var headers = {\n              \"Content-Type\": \"application/json\",\n              Authorization: 'Token ' + sessionStorage.getItem('token')\n            };\n            axios.post(url, params, {\n              headers: headers\n            }).then(function (res) {\n              var _res$data5 = res.data,\n                  msg = _res$data5.msg,\n                  code = _res$data5.code,\n                  data = _res$data5.data;\n              self.editForm.loading = false;\n\n              if (code === '999999') {\n                self.$message({\n                  message: '执行成功',\n                  center: true,\n                  type: 'success'\n                });\n                self.$refs['editForm'].resetFields();\n                self.editForm.visible = false;\n                self.getProjectConfig();\n              } else if (code === '999997') {\n                self.$message.error({\n                  message: msg,\n                  center: true\n                });\n              } else {\n                self.$message.error({\n                  message: msg,\n                  center: true\n                });\n              }\n            });\n          }).catch(function () {});\n        }\n      });\n    },\n    selsChange: function selsChange(sels) {\n      this.sels = sels;\n    },\n    //批量删除\n    batchRemove: function batchRemove() {\n      var _this3 = this;\n\n      var ids = this.sels.map(function (item) {\n        return item.id;\n      });\n      var self = this;\n      this.$confirm('确认删除选中记录吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        self.listLoading = true; //NProgress.start();\n\n        var params = {\n          project_id: Number(_this3.$route.params.project_id),\n          ids: ids\n        };\n        var headers = {\n          \"Content-Type\": \"application/json\",\n          Authorization: 'Token ' + sessionStorage.getItem('token')\n        };\n        axios.post(\"\".concat(test, \"/api/project/del_config\"), params, {\n          headers: headers\n        }).then(function (res) {\n          var _res$data6 = res.data,\n              msg = _res$data6.msg,\n              code = _res$data6.code,\n              data = _res$data6.data;\n          self.listLoading = false;\n\n          if (code === '999999') {\n            self.$message({\n              message: '删除成功',\n              center: true,\n              type: 'success'\n            });\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n\n          self.getProjectConfig();\n        });\n      }).catch(function () {});\n    }\n  },\n  mounted: function mounted() {\n    this.getProjectConfig();\n  }\n};",{"version":3,"sources":["projectConfig.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA,SAAA,IAAA;AACA,OAAA,KAAA,MAAA,OAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,CAAA;AAAA,QAAA,KAAA,EAAA,KAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAAA,EACA;AAAA,QAAA,KAAA,EAAA,MAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OADA,EAEA;AAAA,QAAA,KAAA,EAAA,QAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAFA,CADA;AAIA,MAAA,OAAA,EAAA;AACA,QAAA,IAAA,EAAA;AADA,OAJA;AAOA,MAAA,OAAA,EAAA,EAPA;AAQA,MAAA,KAAA,EAAA,CARA;AASA,MAAA,IAAA,EAAA,CATA;AAUA,MAAA,KAAA,EAAA,CAVA;AAWA,MAAA,WAAA,EAAA,KAXA;AAYA,MAAA,IAAA,EAAA,EAZA;AAYA;AACA,MAAA,QAAA,EAAA;AACA;AACA,QAAA,IAAA,EAAA;AACA,UAAA,EAAA,EAAA,EADA;AAEA,UAAA,IAAA,EAAA,EAFA;AAGA,UAAA,IAAA,EAAA,KAHA;AAIA,UAAA,KAAA,EAAA,EAJA;AAKA,UAAA,WAAA,EAAA;AALA,SAFA;AASA,QAAA,KAAA,EAAA,EATA;AAUA,QAAA,OAAA,EAAA,KAVA;AAUA;AACA,QAAA,OAAA,EAAA,KAXA;AAYA,QAAA,KAAA,EAAA;AACA,UAAA,IAAA,EAAA,CACA;AAAA,YAAA,QAAA,EAAA,IAAA;AAAA,YAAA,OAAA,EAAA,OAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WADA,EAEA;AAAA,YAAA,GAAA,EAAA,CAAA;AAAA,YAAA,GAAA,EAAA,EAAA;AAAA,YAAA,OAAA,EAAA,gBAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WAFA,CADA;AAKA,UAAA,IAAA,EAAA,CACA;AAAA,YAAA,QAAA,EAAA,IAAA;AAAA,YAAA,OAAA,EAAA,OAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WADA,CALA;AAQA,UAAA,KAAA,EAAA,CACA;AAAA,YAAA,QAAA,EAAA,IAAA;AAAA,YAAA,OAAA,EAAA,MAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WADA,CARA;AAWA,UAAA,WAAA,EAAA,CACA;AAAA,YAAA,QAAA,EAAA,KAAA;AAAA,YAAA,OAAA,EAAA,OAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WADA,EAEA;AAAA,YAAA,GAAA,EAAA,IAAA;AAAA,YAAA,OAAA,EAAA,aAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WAFA;AAXA;AAZA;AAbA,KAAA;AA2CA,GA7CA;AA8CA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,SAFA,qBAEA,EAFA,EAEA;AACA,UAAA,GAAA,GAAA,0IAAA;AACA,UAAA,OAAA,GAAA,0OAAA;AAEA,aAAA,OAAA,CAAA,IAAA,CAAA,EAAA,KAAA,GAAA,CAAA,IAAA,CAAA,EAAA,CAAA;AACA,KAPA;AAQA,IAAA,YARA,0BAQA;AACA,WAAA,IAAA,GAAA,CAAA;AACA,WAAA,gBAAA;AACA,KAXA;AAYA;AACA,IAAA,gBAbA,8BAaA;AACA,WAAA,WAAA,GAAA,IAAA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,UAAA,MAAA,GAAA;AACA,QAAA,UAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA,UADA;AAEA,QAAA,IAAA,EAAA,IAAA,CAAA,IAFA;AAGA,QAAA,IAAA,EAAA,IAAA,CAAA,OAAA,CAAA,IAHA;AAIA,QAAA,IAAA,EAAA,IAAA,CAAA,OAAA,CAAA;AAJA,OAAA;AAMA,UAAA,OAAA,GAAA;AACA,QAAA,aAAA,EAAA,WAAA,cAAA,CAAA,OAAA,CAAA,OAAA;AADA,OAAA;AAGA,MAAA,KAAA,CAAA,GAAA,WAAA,IAAA,+BAAA;AAAA,QAAA,MAAA,EAAA,MAAA;AAAA,QAAA,OAAA,EAAA;AAAA,OAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AAAA,wBACA,GAAA,CAAA,IADA;AAAA,YACA,GADA,aACA,GADA;AAAA,YACA,IADA,aACA,IADA;AAAA,YACA,IADA,aACA,IADA;AAEA,QAAA,IAAA,CAAA,WAAA,GAAA,KAAA;;AACA,YAAA,IAAA,KAAA,QAAA,EAAA;AACA,UAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,IAAA;AACA,UAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,SAJA,MAKA;AACA,UAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,YAAA,OAAA,EAAA,GADA;AAEA,YAAA,MAAA,EAAA;AAFA,WAAA;AAIA;AACA,OAdA;AAeA,KAxCA;AAyCA;AACA,IAAA,SAAA,EAAA,mBAAA,KAAA,EAAA,GAAA,EAAA;AAAA;;AACA,WAAA,QAAA,CAAA,YAAA,GAAA,CAAA,IAAA,GAAA,KAAA,EAAA,IAAA,EAAA;AACA,QAAA,IAAA,EAAA;AADA,OAAA,EAEA,IAFA,CAEA,YAAA;AACA,QAAA,KAAA,CAAA,WAAA,GAAA,IAAA,CADA,CAEA;;AACA,YAAA,IAAA,GAAA,KAAA;AACA,YAAA,MAAA,GAAA;AACA,UAAA,UAAA,EAAA,MAAA,CAAA,KAAA,CAAA,MAAA,CAAA,MAAA,CAAA,UAAA,CADA;AAEA,UAAA,GAAA,EAAA,CAAA,GAAA,CAAA,EAAA;AAFA,SAAA;AAIA,YAAA,OAAA,GAAA;AACA,0BAAA,kBADA;AAEA,UAAA,aAAA,EAAA,WAAA,cAAA,CAAA,OAAA,CAAA,OAAA;AAFA,SAAA;AAIA,QAAA,KAAA,CAAA,IAAA,WAAA,IAAA,8BAAA,MAAA,EAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,UAAA,IAAA,CAAA,WAAA,GAAA,KAAA;AADA,2BAEA,GAAA,CAAA,IAFA;AAAA,cAEA,GAFA,cAEA,GAFA;AAAA,cAEA,IAFA,cAEA,IAFA;AAAA,cAEA,IAFA,cAEA,IAFA;;AAGA,cAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA;AACA,cAAA,OAAA,EAAA,MADA;AAEA,cAAA,MAAA,EAAA,IAFA;AAGA,cAAA,IAAA,EAAA;AAHA,aAAA;AAKA,WANA,MAMA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,cAAA,OAAA,EAAA,GADA;AAEA,cAAA,MAAA,EAAA;AAFA,aAAA;AAIA;;AACA,UAAA,IAAA,CAAA,gBAAA;AACA,SAhBA;AAiBA,OA/BA,EA+BA,KA/BA,CA+BA,YAAA,CACA,CAhCA;AAiCA,KA5EA;AA6EA,IAAA,kBAAA,EAAA,4BAAA,KAAA,EAAA,GAAA,EAAA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,WAAA,GAAA,IAAA;AACA,UAAA,MAAA,GAAA;AACA,QAAA,UAAA,EAAA,MAAA,CAAA,KAAA,MAAA,CAAA,MAAA,CAAA,UAAA,CADA;AAEA,QAAA,SAAA,EAAA,MAAA,CAAA,GAAA,CAAA,EAAA;AAFA,OAAA;AAIA,UAAA,OAAA,GAAA;AACA,wBAAA,kBADA;AAEA,QAAA,aAAA,EAAA,WAAA,cAAA,CAAA,OAAA,CAAA,OAAA;AAFA,OAAA;;AAIA,UAAA,GAAA,CAAA,MAAA,EAAA;AACA,QAAA,KAAA,CAAA,IAAA,WAAA,IAAA,kCAAA,MAAA,EAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AAAA,2BACA,GAAA,CAAA,IADA;AAAA,cACA,GADA,cACA,GADA;AAAA,cACA,IADA,cACA,IADA;AAAA,cACA,IADA,cACA,IADA;AAEA,UAAA,IAAA,CAAA,WAAA,GAAA,KAAA;;AACA,cAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA;AACA,cAAA,OAAA,EAAA,MADA;AAEA,cAAA,MAAA,EAAA,IAFA;AAGA,cAAA,IAAA,EAAA;AAHA,aAAA;AAKA,YAAA,GAAA,CAAA,MAAA,GAAA,CAAA,GAAA,CAAA,MAAA;AACA,WAPA,MAQA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,cAAA,OAAA,EAAA,GADA;AAEA,cAAA,MAAA,EAAA;AAFA,aAAA;AAIA;AACA,SAjBA;AAkBA,OAnBA,MAmBA;AACA,QAAA,KAAA,CAAA,IAAA,WAAA,IAAA,iCAAA,MAAA,EAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AAAA,2BACA,GAAA,CAAA,IADA;AAAA,cACA,GADA,cACA,GADA;AAAA,cACA,IADA,cACA,IADA;AAAA,cACA,IADA,cACA,IADA;AAEA,UAAA,IAAA,CAAA,WAAA,GAAA,KAAA;;AACA,cAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA;AACA,cAAA,OAAA,EAAA,MADA;AAEA,cAAA,MAAA,EAAA,IAFA;AAGA,cAAA,IAAA,EAAA;AAHA,aAAA;AAKA,YAAA,GAAA,CAAA,MAAA,GAAA,CAAA,GAAA,CAAA,MAAA;AACA,WAPA,MAQA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,cAAA,OAAA,EAAA,GADA;AAEA,cAAA,MAAA,EAAA;AAFA,aAAA;AAIA;AACA,SAjBA;AAkBA;AACA,KA/HA;AAgIA,IAAA,mBAhIA,+BAgIA,GAhIA,EAgIA;AACA,WAAA,IAAA,GAAA,GAAA;AACA,WAAA,gBAAA;AACA,KAnIA;AAoIA;AACA,IAAA,UAAA,EAAA,oBAAA,KAAA,EAAA,GAAA,EAAA;AACA,WAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,OAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,IAAA,GAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,GAAA,CAAA;AACA,KAzIA;AA0IA;AACA,IAAA,SAAA,EAAA,qBAAA;AACA,WAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,OAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,IAAA,GAAA;AACA,QAAA,EAAA,EAAA,EADA;AAEA,QAAA,IAAA,EAAA,EAFA;AAGA,QAAA,IAAA,EAAA,KAHA;AAIA,QAAA,KAAA,EAAA,EAJA;AAKA,QAAA,WAAA,EAAA;AALA,OAAA;AAOA,KArJA;AAsJA;AACA,IAAA,UAAA,EAAA,sBAAA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,KAAA,CAAA,QAAA,CAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,QAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,CAAA,YAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,OAAA,GAAA,IAAA,CADA,CAEA;;AACA,gBAAA,MAAA,GAAA;AACA,cAAA,UAAA,EAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,UAAA,CADA;AAEA,cAAA,IAAA,EAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,IAFA;AAGA,cAAA,IAAA,EAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,IAHA;AAIA,cAAA,KAAA,EAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,KAJA;AAKA,cAAA,WAAA,EAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA;AALA,aAAA;AAOA,gBAAA,GAAA,aAAA,IAAA,4BAAA;;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,IAAA,EAAA,EAAA;AACA,cAAA,GAAA,aAAA,IAAA,+BAAA;AACA,cAAA,MAAA,CAAA,IAAA,CAAA,GAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,CAAA;AACA;;AACA,gBAAA,OAAA,GAAA;AACA,8BAAA,kBADA;AAEA,cAAA,aAAA,EAAA,WAAA,cAAA,CAAA,OAAA,CAAA,OAAA;AAFA,aAAA;AAIA,YAAA,KAAA,CAAA,IAAA,CAAA,GAAA,EAAA,MAAA,EAAA;AAAA,cAAA,OAAA,EAAA;AAAA,aAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AAAA,+BACA,GAAA,CAAA,IADA;AAAA,kBACA,GADA,cACA,GADA;AAAA,kBACA,IADA,cACA,IADA;AAAA,kBACA,IADA,cACA,IADA;AAEA,cAAA,IAAA,CAAA,QAAA,CAAA,OAAA,GAAA,KAAA;;AACA,kBAAA,IAAA,KAAA,QAAA,EAAA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA;AACA,kBAAA,OAAA,EAAA,MADA;AAEA,kBAAA,MAAA,EAAA,IAFA;AAGA,kBAAA,IAAA,EAAA;AAHA,iBAAA;AAKA,gBAAA,IAAA,CAAA,KAAA,CAAA,UAAA,EAAA,WAAA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,OAAA,GAAA,KAAA;AACA,gBAAA,IAAA,CAAA,gBAAA;AACA,eATA,MASA,IAAA,IAAA,KAAA,QAAA,EAAA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,kBAAA,OAAA,EAAA,GADA;AAEA,kBAAA,MAAA,EAAA;AAFA,iBAAA;AAIA,eALA,MAKA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,kBAAA,OAAA,EAAA,GADA;AAEA,kBAAA,MAAA,EAAA;AAFA,iBAAA;AAIA;AACA,aAvBA;AAwBA,WA3CA,EA2CA,KA3CA,CA2CA,YAAA,CAAA,CA3CA;AA4CA;AACA,OA/CA;AAgDA,KAzMA;AA0MA,IAAA,UAAA,EAAA,oBAAA,IAAA,EAAA;AACA,WAAA,IAAA,GAAA,IAAA;AACA,KA5MA;AA6MA;AACA,IAAA,WAAA,EAAA,uBAAA;AAAA;;AACA,UAAA,GAAA,GAAA,KAAA,IAAA,CAAA,GAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,EAAA;AAAA,OAAA,CAAA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,YAAA,EAAA,IAAA,EAAA;AACA,QAAA,IAAA,EAAA;AADA,OAAA,EAEA,IAFA,CAEA,YAAA;AACA,QAAA,IAAA,CAAA,WAAA,GAAA,IAAA,CADA,CAEA;;AACA,YAAA,MAAA,GAAA;AACA,UAAA,UAAA,EAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,UAAA,CADA;AAEA,UAAA,GAAA,EAAA;AAFA,SAAA;AAIA,YAAA,OAAA,GAAA;AACA,0BAAA,kBADA;AAEA,UAAA,aAAA,EAAA,WAAA,cAAA,CAAA,OAAA,CAAA,OAAA;AAFA,SAAA;AAIA,QAAA,KAAA,CAAA,IAAA,WAAA,IAAA,8BAAA,MAAA,EAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AAAA,2BACA,GAAA,CAAA,IADA;AAAA,cACA,GADA,cACA,GADA;AAAA,cACA,IADA,cACA,IADA;AAAA,cACA,IADA,cACA,IADA;AAEA,UAAA,IAAA,CAAA,WAAA,GAAA,KAAA;;AACA,cAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA;AACA,cAAA,OAAA,EAAA,MADA;AAEA,cAAA,MAAA,EAAA,IAFA;AAGA,cAAA,IAAA,EAAA;AAHA,aAAA;AAKA,WANA,MAOA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA;AACA,cAAA,OAAA,EAAA,GADA;AAEA,cAAA,MAAA,EAAA;AAFA,aAAA;AAIA;;AACA,UAAA,IAAA,CAAA,gBAAA;AACA,SAjBA;AAkBA,OA/BA,EA+BA,KA/BA,CA+BA,YAAA,CAAA,CA/BA;AAgCA;AAjPA,GA9CA;AAiSA,EAAA,OAjSA,qBAiSA;AACA,SAAA,gBAAA;AACA;AAnSA,CAAA","sourcesContent":["<template>\n    <div style=\"margin:35px\">\n        <!--工具条-->\n        <el-col :span=\"24\" class=\"toolbar\" style=\"padding-bottom: 0px;\">\n            <el-form :inline=\"true\" :model=\"filters\" @submit.native.prevent>\n                <el-form-item>\n                    <el-input v-model.trim=\"filters.name\" placeholder=\"名称\" @keyup.enter.native=\"handleSearch\"></el-input>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"handleAdd\">新增</el-button>\n                </el-form-item>\n            </el-form>\n        </el-col>\n        <!--列表-->\n        <el-table :data=\"project\" highlight-current-row v-loading=\"listLoading\" @selection-change=\"selsChange\" style=\"width: 100%;\">\n            <el-table-column type=\"selection\" min-width=\"5%\">\n            </el-table-column>\n            <el-table-column prop=\"name\" label=\"名称\" min-width=\"15%\" show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column prop=\"type\" label=\"类型\" min-width=\"5%\" show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column prop=\"value\" label=\"值\" min-width=\"25%\" show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column prop=\"description\" label=\"描述\" min-width=\"25%\" show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column prop=\"status\" label=\"状态\" min-width=\"5%\">\n                <template slot-scope=\"scope\">\n                    <img v-show=\"scope.row.status\" src=\"@/assets/icon-yes.svg\"/>\n                    <img v-show=\"!scope.row.status\" src=\"@/assets/icon-no.svg\"/>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" min-width=\"20%\">\n                <template slot-scope=\"scope\">\n                  <!--<el-button-group>-->\n                    <!--<el-button size=\"small\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>-->\n                    <!--<el-button type=\"danger\" size=\"small\" @click=\"handleDel(scope.$index, scope.row)\">删除</el-button>-->\n                    <!--<el-button type=\"info\" size=\"small\" @click=\"handleChangeStatus(scope.$index, scope.row)\">{{scope.row.status===false?'启用':'禁用'}}</el-button>-->\n                  <!--</el-button-group>-->\n                  <el-dropdown>\n                    <el-button size=\"small\" type=\"primary\" @click=\"handleEdit(scope.$index, scope.row)\" plain>编辑<i class=\"el-icon-arrow-down el-icon--right\"></i></el-button>\n                    <el-dropdown-menu slot=\"dropdown\">\n                      <el-dropdown-item><el-button type=\"danger\" size=\"small\" @click=\"handleDel(scope.$index, scope.row)\" plain>删除</el-button></el-dropdown-item>\n                      <el-dropdown-item><el-button type=\"info\" size=\"small\" @click=\"handleChangeStatus(scope.$index, scope.row)\" plain>{{scope.row.status===false?'启用':'禁用'}}</el-button></el-dropdown-item>\n                    </el-dropdown-menu>\n                  </el-dropdown>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <!--工具条-->\n        <el-col :span=\"24\" class=\"toolbar\">\n            <el-button type=\"danger\" @click=\"batchRemove\" :disabled=\"this.sels.length===0\">批量删除</el-button>\n            <el-pagination layout=\"total, prev, pager, next\" @current-change=\"handleCurrentChange\" :current-page.sync=\"page\" :total=\"total\" :page-size=\"20\" :page-count=\"pages\" style=\"float:right;\">\n            </el-pagination>\n        </el-col>\n\n        <!--编辑界面-->\n        <el-dialog width=\"40%\" :title=\"editForm.title\" :visible.sync=\"editForm.visible\" :close-on-click-modal=\"false\">\n            <el-form :model=\"editForm.data\"  :rules=\"editForm.rules\" ref=\"editForm\" label-width=\"80px\">\n                <el-form-item label=\"名称\" prop=\"name\">\n                    <el-input v-model.trim=\"editForm.data.name\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"类型\" prop=\"type\">\n                    <el-select v-model=\"editForm.data.type\"  placeholder=\"类型\">\n                        <el-option v-for=\"(item,index) in type\" :label=\"item.label\" :value=\"item.value\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"值\" prop='value'>\n                    <el-input type=\"textarea\" :rows=\"5\" v-model.trim=\"editForm.data.value\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"描述\" prop='description'>\n                    <el-input type=\"textarea\" :rows=\"5\" v-model.trim=\"editForm.data.description\"></el-input>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click.native=\"editForm.visible = false\">取消</el-button>\n                <el-button type=\"primary\" @click.native=\"editSubmit\" :loading=\"editForm.loading\">提交</el-button>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\n    //import NProgress from 'nprogress'\n    import { test } from '../../api/api';\n    import axios from 'axios';\n    export default {\n        data() {\n            return {\n                type: [{value: 'env', label: '环境'},\n                    {value: 'data', label: '数据'},\n                    {value: 'config', label: '配置'}],\n                filters: {\n                    name: ''\n                },\n                project: [],\n                total: 0,\n                page: 1,\n                pages: 0,\n                listLoading: false,\n                sels: [],//列表选中列\n                editForm:{\n                    //编辑界面数据\n                    data: {\n                        id: '',\n                        name: '',\n                        type: 'env',\n                        value: '',\n                        description: ''\n                    },\n                    title: \"\",\n                    visible: false,//编辑界面是否显示\n                    loading: false,\n                    rules: {\n                        name: [\n                            { required: true, message: '请输入名称', trigger: 'blur' },\n                            { min: 1, max: 50, message: '长度在 1 到 50 个字符', trigger: 'blur' }\n                        ],\n                        type : [\n                            { required: true, message: '请选择类型', trigger: 'blur'}\n                        ],\n                        value: [\n                            { required: true, message: '请输入值', trigger: 'blur' },\n                        ],\n                        description: [\n                            { required: false, message: '请输入描述', trigger: 'blur' },\n                            { max: 1024, message: '不能超过1024个字符', trigger: 'blur' }\n                        ]\n                    },\n                },\n            }\n        },\n        methods: {\n            // IP格式验证\n            isValidIP(ip) {\n                var reg = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])$/;\n                var regPort = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5]):([0-9]|[1-9]\\d|[1-9]\\d{2}|[1-9]\\d{3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])$$/;\n\n                return regPort.test(ip) || reg.test(ip);\n            },\n            handleSearch(){\n                this.page=1;\n                this.getProjectConfig();\n            },\n            // 获取HOST列表\n            getProjectConfig() {\n                this.listLoading = true;\n                let self = this;\n                let params = {\n                    project_id: this.$route.params.project_id,\n                    page: self.page,\n                    name: self.filters.name,\n                    type: self.filters.type,\n                };\n                let headers = {\n                    Authorization: 'Token '+sessionStorage.getItem('token')\n                };\n                axios.get(`${test}/api/project/config_list`, { params: params, headers:headers}).then(res => {\n                    let { msg, code, data } = res.data;\n                    self.listLoading = false;\n                    if (code === '999999') {\n                        self.total = data.total;\n                        self.project = data.data;\n                        self.pages=data.pages;\n                    }\n                    else {\n                        self.$message.error({\n                            message: msg,\n                            center: true,\n                        })\n                    }\n                });\n            },\n            //删除\n            handleDel: function (index, row) {\n                this.$confirm('确认删除配置[' + row.name + ']吗?', '提示', {\n                    type: 'warning'\n                }).then(() => {\n                    this.listLoading = true;\n                    //NProgress.start();\n                    let self = this;\n                    let params = {\n                        project_id: Number(this.$route.params.project_id),\n                        ids: [row.id, ]\n                    };\n                    let headers = {\n                        \"Content-Type\": \"application/json\",\n                        Authorization: 'Token '+sessionStorage.getItem('token')\n                    };\n                    axios.post(`${test}/api/project/del_config`, params, {headers}).then(res => {\n                        self.listLoading = false;\n                        let { msg, code, data } = res.data;\n                        if (code === '999999') {\n                            self.$message({\n                                message: '删除成功',\n                                center: true,\n                                type: 'success'\n                            })\n                        } else {\n                            self.$message.error({\n                                message: msg,\n                                center: true,\n                            })\n                        }\n                        self.getProjectConfig();\n                    });\n                }).catch(() => {\n                });\n            },\n            handleChangeStatus: function(index, row) {\n                let self = this;\n                this.listLoading = true;\n                let params = {\n                    project_id: Number(this.$route.params.project_id),\n                    config_id: Number(row.id)\n                };\n                let headers = {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: 'Token '+sessionStorage.getItem('token')\n                };\n                if (row.status) {\n                    axios.post(`${test}/api/project/disable_config`, params, {headers}).then(res => {\n                        let {msg, code, data} = res.data;\n                        self.listLoading = false;\n                        if (code === '999999') {\n                            self.$message({\n                                message: '禁用成功',\n                                center: true,\n                                type: 'success'\n                            });\n                            row.status = !row.status;\n                        }\n                        else {\n                            self.$message.error({\n                                message: msg,\n                                center: true,\n                            })\n                        }\n                    });\n                } else {\n                    axios.post(`${test}/api/project/enable_config`, params, {headers}).then(res => {\n                        let {msg, code, data} = res.data;\n                        self.listLoading = false;\n                        if (code === '999999') {\n                            self.$message({\n                                message: '启用成功',\n                                center: true,\n                                type: 'success'\n                            });\n                            row.status = !row.status;\n                        }\n                        else {\n                            self.$message.error({\n                                message: msg,\n                                center: true,\n                            })\n                        }\n                    });\n                }\n            },\n            handleCurrentChange(val) {\n                this.page = val;\n                this.getProjectConfig()\n            },\n            //显示编辑界面\n            handleEdit: function (index, row) {\n                this.editForm.title=\"编辑\";\n                this.editForm.visible = true;\n                this.editForm.data = Object.assign({}, row);\n            },\n            //显示新增界面\n            handleAdd: function () {\n                this.editForm.title=\"新增\";\n                this.editForm.visible = true;\n                this.editForm.data = {\n                        id: '',\n                        name: '',\n                        type: 'env',\n                        value: '',\n                        description: ''\n                    };\n            },\n            //编辑\n            editSubmit: function () {\n                let self = this;\n                this.$refs.editForm.validate((valid) => {\n                    if (valid) {\n                        this.$confirm('确认提交吗？', '提示', {}).then(() => {\n                            self.editForm.loading = true;\n                            //NProgress.start();\n                            let params = {\n                                project_id: Number(this.$route.params.project_id),\n                                name: self.editForm.data.name,\n                                type: self.editForm.data.type,\n                                value: self.editForm.data.value,\n                                description: self.editForm.data.description\n                            };\n                            let url=`${test}/api/project/add_config`;\n                            if(self.editForm.data.id!=\"\"){\n                                url=`${test}/api/project/update_config`;\n                                params[\"id\"]=Number(self.editForm.data.id);\n                            }\n                            let headers = {\n                                \"Content-Type\": \"application/json\",\n                                Authorization: 'Token '+sessionStorage.getItem('token')\n                            };\n                            axios.post(url, params, {headers}).then(res => {\n                                let {msg, code, data} = res.data;\n                                self.editForm.loading = false;\n                                if (code === '999999') {\n                                    self.$message({\n                                        message: '执行成功',\n                                        center: true,\n                                        type: 'success'\n                                    });\n                                    self.$refs['editForm'].resetFields();\n                                    self.editForm.visible = false;\n                                    self.getProjectConfig();\n                                } else if (code === '999997'){\n                                    self.$message.error({\n                                        message: msg,\n                                        center: true,\n                                    })\n                                } else {\n                                    self.$message.error({\n                                        message: msg,\n                                        center: true,\n                                    })\n                                }\n                            })\n                        }).catch(() => {});\n                    }\n                });\n            },\n            selsChange: function (sels) {\n                this.sels = sels;\n            },\n            //批量删除\n            batchRemove: function () {\n                let ids = this.sels.map(item => item.id);\n                let self = this;\n                this.$confirm('确认删除选中记录吗？', '提示', {\n                    type: 'warning'\n                }).then(() => {\n                    self.listLoading = true;\n                    //NProgress.start();\n                    let params = {\n                        project_id: Number(this.$route.params.project_id),\n                        ids: ids\n                    };\n                    let headers = {\n                        \"Content-Type\": \"application/json\",\n                        Authorization: 'Token ' + sessionStorage.getItem('token')\n                    };\n                    axios.post(`${test}/api/project/del_config`, params, {headers}).then(res => {\n                        let {msg, code, data} = res.data;\n                        self.listLoading = false;\n                        if (code === '999999') {\n                            self.$message({\n                                message: '删除成功',\n                                center: true,\n                                type: 'success'\n                            })\n                        }\n                        else {\n                            self.$message.error({\n                                message: msg,\n                                center: true,\n                            })\n                        }\n                        self.getProjectConfig();\n                    })\n                }).catch(() => {});\n            }\n        },\n        mounted() {\n            this.getProjectConfig();\n        }\n    }\n\n</script>\n<style>\n</style>\n"],"sourceRoot":"src/views/project"}]}