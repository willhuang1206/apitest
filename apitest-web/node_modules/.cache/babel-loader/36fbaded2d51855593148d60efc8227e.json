{"remainingRequest":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/thread-loader/dist/cjs.js!/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js!/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangrong/workspace/apitest/apitest-web/src/views/project/projectList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangrong/workspace/apitest/apitest-web/src/views/project/projectList.vue","mtime":1588749633783},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//import NProgress from 'nprogress'\nimport { test } from \"../../api/api\";\nimport axios from \"axios\";\nexport default {\n  // components: {ElRow},\n  data: function data() {\n    return {\n      filters: {\n        name: '',\n        businessline: ''\n      },\n      project: [],\n      total: 0,\n      page: 1,\n      pages: 0,\n      listLoading: false,\n      sels: [],\n      //列表选中列\n      form: {\n        data: {\n          id: '',\n          name: '',\n          version: '',\n          type: '',\n          description: '',\n          businessline: ''\n        },\n        visible: false,\n        loading: false,\n        rules: {\n          name: [{\n            required: true,\n            message: '请输入名称',\n            trigger: 'blur'\n          }, {\n            min: 1,\n            max: 50,\n            message: '长度在 1 到 50 个字符',\n            trigger: 'blur'\n          }],\n          type: [{\n            required: true,\n            message: '请选择类型',\n            trigger: 'blur'\n          }],\n          version: [{\n            required: true,\n            message: '请输入版本号',\n            trigger: 'blur'\n          }, {\n            min: 1,\n            max: 20,\n            message: '长度在 1 到 20 个字符',\n            trigger: 'blur'\n          }],\n          description: [{\n            required: false,\n            message: '请输入描述',\n            trigger: 'blur'\n          }, {\n            max: 1024,\n            message: '不能超过1024个字符',\n            trigger: 'blur'\n          }]\n        }\n      },\n      options: [{\n        label: \"Web\",\n        value: \"Web\"\n      }, {\n        label: \"App\",\n        value: \"App\"\n      }],\n      businesslinelist: [{\n        name: \"集团科技\"\n      }, {\n        name: \"加油宝科技\"\n      }, {\n        name: \"物流科技\"\n      }, {\n        name: \"金融科技\"\n      }, {\n        name: \"其他\"\n      }]\n    };\n  },\n  methods: {\n    // 获取项目列表\n    getProjectList: function getProjectList() {\n      this.listLoading = true;\n      var self = this;\n      sessionStorage.setItem(\"businessline\", self.filters.businessline);\n      var params = {\n        page: self.page,\n        name: self.filters.name,\n        businessline: self.filters.businessline\n      };\n      var headers = {\n        Authorization: 'Token ' + sessionStorage.getItem('token')\n      };\n      axios.get(\"\".concat(test, \"/api/project/project_list\"), {\n        params: params,\n        headers: headers\n      }).then(function (res) {\n        self.listLoading = false;\n        var _res$data = res.data,\n            msg = _res$data.msg,\n            code = _res$data.code,\n            data = _res$data.data;\n\n        if (code === '999999') {\n          self.total = data.total;\n          self.project = data.data;\n          self.pages = data.pages;\n        } else {\n          self.$message.error({\n            message: msg,\n            center: true\n          });\n        }\n      });\n    },\n    handleSearch: function handleSearch() {\n      this.page = 1;\n      this.getProjectList();\n    },\n    //删除\n    handleDel: function handleDel(index, row) {\n      var _this = this;\n\n      this.$confirm('确认删除项目[' + row.name + ']吗?', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this.listLoading = true; //NProgress.start();\n\n        var self = _this;\n        var params = {\n          ids: [row.id]\n        };\n        var header = {\n          \"Content-Type\": \"application/json\",\n          Authorization: 'Token ' + sessionStorage.getItem('token')\n        };\n        axios.post(\"\".concat(test, \"/api/project/del_project\"), params, {\n          header: header\n        }).then(function (res) {\n          var _res$data2 = res.data,\n              msg = _res$data2.msg,\n              code = _res$data2.code,\n              data = _res$data2.data;\n\n          if (code === '999999') {\n            self.$message({\n              message: '删除成功',\n              center: true,\n              type: 'success'\n            });\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n\n          self.getProjectList();\n        });\n      }).catch(function () {});\n    },\n    // 改变项目状态\n    handleChangeStatus: function handleChangeStatus(index, row) {\n      var self = this;\n      this.listLoading = true;\n      var params = {\n        project_id: row.id\n      };\n      var headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: 'Token ' + sessionStorage.getItem('token')\n      };\n\n      if (row.status) {\n        axios.post(\"\".concat(test, \"/api/project/disable_project\"), params, {\n          headers: headers\n        }).then(function (res) {\n          var _res$data3 = res.data,\n              msg = _res$data3.msg,\n              code = _res$data3.code,\n              data = _res$data3.data;\n          self.listLoading = false;\n\n          if (code === '999999') {\n            self.$message({\n              message: '禁用成功',\n              center: true,\n              type: 'success'\n            });\n            row.status = !row.status;\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n        });\n      } else {\n        axios.post(\"\".concat(test, \"/api/project/enable_project\"), params, {\n          headers: headers\n        }).then(function (res) {\n          var _res$data4 = res.data,\n              msg = _res$data4.msg,\n              code = _res$data4.code,\n              data = _res$data4.data;\n          self.listLoading = false;\n\n          if (code === '999999') {\n            self.$message({\n              message: '启用成功',\n              center: true,\n              type: 'success'\n            });\n            row.status = !row.status;\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n        });\n      }\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.page = val;\n      this.getProjectList();\n    },\n    //显示编辑界面\n    handleEdit: function handleEdit(index, row) {\n      this.form.title = \"编辑\";\n      this.form.visible = true;\n      this.form.data = Object.assign({}, row);\n    },\n    //显示新增界面\n    handleAdd: function handleAdd() {\n      this.form.title = \"新增\";\n      this.form.visible = true;\n      this.form.data = {\n        id: '',\n        name: '',\n        version: '',\n        type: '',\n        description: '',\n        businessline: ''\n      };\n    },\n    //编辑\n    editSubmit: function editSubmit() {\n      var _this2 = this;\n\n      var self = this;\n      this.$refs.form.validate(function (valid) {\n        if (valid) {\n          _this2.$confirm('确认提交吗？', '提示', {}).then(function () {\n            self.form.loading = true; //NProgress.start();\n\n            var params = {\n              name: self.form.data.name,\n              type: self.form.data.type,\n              version: self.form.data.version,\n              description: self.form.data.description,\n              businessline: self.form.data.businessline\n            };\n            var url = \"\".concat(test, \"/api/project/add_project\");\n\n            if (self.form.data.id != '') {\n              url = \"\".concat(test, \"/api/project/update_project\");\n              params[\"project_id\"] = self.form.data.id;\n            }\n\n            var header = {\n              \"Content-Type\": \"application/json\",\n              Authorization: 'Token ' + sessionStorage.getItem('token')\n            };\n            axios.post(url, params, {\n              headers: header\n            }).then(function (response) {\n              var _response$data = response.data,\n                  msg = _response$data.msg,\n                  code = _response$data.code,\n                  data = _response$data.data;\n              self.form.loading = false;\n\n              if (code === '999999') {\n                self.$message({\n                  message: '执行成功',\n                  center: true,\n                  type: 'success'\n                });\n                self.$refs['form'].resetFields();\n                self.form.visible = false;\n                self.getProjectList();\n              } else if (code === '999997') {\n                self.$message.error({\n                  message: msg,\n                  center: true\n                });\n              } else {\n                self.$message.error({\n                  message: msg,\n                  center: true\n                });\n              }\n            }).catch(function (error) {});\n          }).catch(function () {});\n        }\n      });\n    },\n    selsChange: function selsChange(sels) {\n      this.sels = sels;\n    },\n    //批量删除\n    batchRemove: function batchRemove() {\n      var _this3 = this;\n\n      var ids = this.sels.map(function (item) {\n        return item.id;\n      });\n      var self = this;\n      this.$confirm('确认删除选中记录吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this3.listLoading = true; //NProgress.start();\n\n        var self = _this3;\n        var params = {\n          ids: ids\n        };\n        var header = {\n          \"Content-Type\": \"application/json\",\n          Authorization: 'Token ' + sessionStorage.getItem('token')\n        };\n        axios.post(\"\".concat(test, \"/api/project/del_project\"), params, {\n          header: header\n        }).then(function (res) {\n          var _res$data5 = res.data,\n              msg = _res$data5.msg,\n              code = _res$data5.code,\n              data = _res$data5.data;\n\n          if (code === '999999') {\n            self.$message({\n              message: '删除成功',\n              center: true,\n              type: 'success'\n            });\n          } else {\n            self.$message.error({\n              message: msg,\n              center: true\n            });\n          }\n\n          self.getProjectList();\n        });\n      }).catch(function () {});\n    }\n  },\n  mounted: function mounted() {\n    if (sessionStorage.getItem(\"businessline\") != null) {\n      this.filters.businessline = sessionStorage.getItem(\"businessline\");\n      this.form.data.businessline = sessionStorage.getItem(\"businessline\");\n    }\n\n    this.getProjectList();\n  }\n};",null]}