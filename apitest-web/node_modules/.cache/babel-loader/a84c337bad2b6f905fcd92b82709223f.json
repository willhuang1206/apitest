{"remainingRequest":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js!/Users/huangrong/workspace/apitest/apitest-web/node_modules/eslint-loader/index.js??ref--13-0!/Users/huangrong/workspace/apitest/apitest-web/src/api/api.js","dependencies":[{"path":"/Users/huangrong/workspace/apitest/apitest-web/src/api/api.js","mtime":1590387094708},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/huangrong/workspace/apitest/apitest-web/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fetch = fetch;\nexports.post = post;\nexports.patch = patch;\nexports.put = put;\nexports.runAutomation = exports.getProjectDynamicList = exports.getGlobalPublish = exports.getProjectConfig = exports.requestLogout = exports.test = void 0;\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _vueRouter = _interopRequireDefault(require(\"vue-router\"));\n\nvar _jsCookie = _interopRequireDefault(require(\"js-cookie\"));\n\nvar _elementUi = require(\"element-ui\");\n\nvar test = 'http://127.0.0.1:8092'; //export const test = 'http://apitest.jyblife.com';\n\nexports.test = test;\n\nvar requestLogout = function requestLogout(params) {\n  return _axios.default.get(\"\".concat(test, \"/api/user/logout\"), params).then(function (res) {\n    return res.data;\n  });\n}; // 获取全局配置列表\n\n\nexports.requestLogout = requestLogout;\n\nvar getProjectConfig = function getProjectConfig(headers, params) {\n  return _axios.default.get(\"\".concat(test, \"/api/project/config_list\"), {\n    params: params,\n    headers: headers\n  }).then(function (res) {\n    return res.data;\n  });\n}; // 获取全局配置列表\n\n\nexports.getProjectConfig = getProjectConfig;\n\nvar getGlobalPublish = function getGlobalPublish(headers, params) {\n  return _axios.default.get(\"\".concat(test, \"/api/global/publish_list\"), {\n    params: params,\n    headers: headers\n  }).then(function (res) {\n    return res.data;\n  });\n}; // 获取项目动态\n\n\nexports.getGlobalPublish = getGlobalPublish;\n\nvar getProjectDynamicList = function getProjectDynamicList(headers, params) {\n  return _axios.default.get(\"\".concat(test, \"/api/dynamic/dynamic\"), {\n    params: params,\n    headers: headers\n  }).then(function (res) {\n    return res.data;\n  });\n}; // 运行自动化用例\n\n\nexports.getProjectDynamicList = getProjectDynamicList;\n\nvar runAutomation = function runAutomation(headers, params) {\n  return _axios.default.post(\"\".concat(test, \"/api/automation/run\"), params, {\n    headers: headers\n  }).then(function (res) {\n    return res.data;\n  });\n}; // 默认超时设置\n\n\nexports.runAutomation = runAutomation;\n_axios.default.defaults.timeout = 10000; // 相对路径设置\n\n_axios.default.defaults.baseURL = '';\n_axios.default.defaults.crossDomain = true;\n_axios.default.defaults.withCredentials = true; //http request 拦截器\n\n_axios.default.interceptors.request.use(function (config) {\n  // 获取token\n  var ticket = _jsCookie.default.get('ticket'); // 添加token到headers\n\n\n  if (ticket) {\n    config.headers.Authorization = ticket;\n  } ////参数处理\n  //if(config.method === 'get' && config.url !== '/api/user/login'){\n  //  config.params = config.params;\n  //}else if(config.url !== '/api/user/login'){\n  //  config.data = config.data || {};\n  //  config.params = config.params || {'ticket': ticket};\n  //}\n\n\n  return config;\n}, function (err) {\n  return Promise.reject(err);\n}); //http response 拦截器\n\n\n_axios.default.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  if (error.response) {\n    switch (error.response.status) {\n      case 403:\n        // 返回 401 清除token信息并跳转到登录页面\n        sessionStorage.removeItem('token');\n\n        _jsCookie.default.remove('ticket'); //router.replace({\n        //    path: 'login',\n        //    query: {redirect: router.currentRoute.fullPath}\n        //});\n\n\n        _elementUi.MessageBox.alert(\"登录信息超时,请重新登录!\", \"登录超时\", {\n          confirmButtonText: \"跳转登录页面\",\n          callback: function callback(action) {\n            window.location.href = \"/\";\n          }\n        });\n\n      case 406:\n        // 返回 401 清除token信息并跳转到登录页面\n        //router.replace({\n        //    path: 'login',\n        //    query: {redirect: router.currentRoute.fullPath}\n        //});\n        _elementUi.MessageBox.alert(\"没有权限执行该操作!\", \"没有权限\", {\n          confirmButtonText: \"关闭\",\n          callback: function callback(action) {\n            history.go(0);\n          }\n        });\n\n    }\n  }\n\n  return Promise.reject(error.response.data); // 返回接口返回的错误信息\n});\n/**\n * fetch 请求方法\n * @param url\n * @param params\n * @returns {Promise}\n */\n\n\nfunction fetch(url) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return new Promise(function (resolve, reject) {\n    _axios.default.get(url, {\n      params: params\n    }).then(function (response) {\n      resolve(response.data);\n    }).catch(function (err) {\n      reject(err);\n    });\n  });\n}\n/**\n * post 请求方法\n * @param url\n * @param data\n * @returns {Promise}\n */\n\n\nfunction post(url) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return new Promise(function (resolve, reject) {\n    _axios.default.post(url, data).then(function (response) {\n      resolve(response.data);\n    }, function (err) {\n      reject(err);\n    });\n  });\n}\n/**\n * patch 方法封装\n * @param url\n * @param data\n * @returns {Promise}\n */\n\n\nfunction patch(url) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return new Promise(function (resolve, reject) {\n    _axios.default.patch(url, data).then(function (response) {\n      resolve(response.data);\n    }, function (err) {\n      reject(err);\n    });\n  });\n}\n/**\n * put 方法封装\n * @param url\n * @param data\n * @returns {Promise}\n */\n\n\nfunction put(url) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return new Promise(function (resolve, reject) {\n    _axios.default.put(url, data).then(function (response) {\n      resolve(response.data);\n    }, function (err) {\n      reject(err);\n    });\n  });\n}",{"version":3,"sources":["/Users/huangrong/workspace/apitest/apitest-web/src/api/api.js"],"names":["test","requestLogout","params","axios","get","then","res","data","getProjectConfig","headers","getGlobalPublish","getProjectDynamicList","runAutomation","post","defaults","timeout","baseURL","crossDomain","withCredentials","interceptors","request","use","config","ticket","Cookies","Authorization","err","Promise","reject","response","error","status","sessionStorage","removeItem","remove","MessageBox","alert","confirmButtonText","callback","action","window","location","href","history","go","fetch","url","resolve","catch","patch","put"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACO,IAAMA,IAAI,GAAG,uBAAb,C,CACP;;;;AAEO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,MAAM,EAAI;AAAE,SAAOC,eAAMC,GAAN,WAAaJ,IAAb,uBAAqCE,MAArC,EAA6CG,IAA7C,CAAkD,UAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,IAAR;AAAA,GAArD,CAAP;AAA4E,CAA9G,C,CACP;;;;;AACO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,OAAD,EAAUP,MAAV,EAAqB;AACjD,SAAOC,eAAMC,GAAN,WAAaJ,IAAb,+BAA6C;AAAEE,IAAAA,MAAM,EAAEA,MAAV;AAAkBO,IAAAA,OAAO,EAACA;AAA1B,GAA7C,EAAiFJ,IAAjF,CAAsF,UAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,IAAR;AAAA,GAAzF,CAAP;AAAgH,CAD7G,C,CAEP;;;;;AACO,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACD,OAAD,EAAUP,MAAV,EAAqB;AACjD,SAAOC,eAAMC,GAAN,WAAaJ,IAAb,+BAA6C;AAAEE,IAAAA,MAAM,EAAEA,MAAV;AAAkBO,IAAAA,OAAO,EAACA;AAA1B,GAA7C,EAAiFJ,IAAjF,CAAsF,UAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,IAAR;AAAA,GAAzF,CAAP;AAAgH,CAD7G,C,CAEP;;;;;AACO,IAAMI,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACF,OAAD,EAAUP,MAAV,EAAqB;AACtD,SAAOC,eAAMC,GAAN,WAAaJ,IAAb,2BAAyC;AAAEE,IAAAA,MAAM,EAAEA,MAAV;AAAkBO,IAAAA,OAAO,EAACA;AAA1B,GAAzC,EAA6EJ,IAA7E,CAAkF,UAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,IAAR;AAAA,GAArF,CAAP;AAA4G,CADzG,C,CAEP;;;;;AACO,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACH,OAAD,EAASP,MAAT,EAAoB;AAC7C,SAAOC,eAAMU,IAAN,WAAcb,IAAd,0BAAyCE,MAAzC,EAAiD;AAACO,IAAAA,OAAO,EAAPA;AAAD,GAAjD,EAA4DJ,IAA5D,CAAiE,UAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,IAAR;AAAA,GAApE,CAAP;AAA2F,CADxF,C,CAGP;;;;AACAJ,eAAMW,QAAN,CAAeC,OAAf,GAAyB,KAAzB,C,CACA;;AACAZ,eAAMW,QAAN,CAAeE,OAAf,GAAwB,EAAxB;AACAb,eAAMW,QAAN,CAAeG,WAAf,GAA6B,IAA7B;AACAd,eAAMW,QAAN,CAAeI,eAAf,GAAkC,IAAlC,C,CACA;;AACAf,eAAMgB,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACE,UAAAC,MAAM,EAAI;AACR;AACA,MAAMC,MAAM,GAAGC,kBAAQpB,GAAR,CAAY,QAAZ,CAAf,CAFQ,CAGR;;;AACA,MAAGmB,MAAH,EAAU;AACRD,IAAAA,MAAM,CAACb,OAAP,CAAegB,aAAf,GAA+BF,MAA/B;AACD,GANO,CAOR;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAAOD,MAAP;AACD,CAhBH,EAiBE,UAAAI,GAAG,EAAI;AACL,SAAOC,OAAO,CAACC,MAAR,CAAeF,GAAf,CAAP;AACD,CAnBH,E,CAuBA;;;AACAvB,eAAMgB,YAAN,CAAmBU,QAAnB,CAA4BR,GAA5B,CACE,UAAAQ,QAAQ,EAAI;AACV,SAAOA,QAAP;AACD,CAHH,EAIE,UAAAC,KAAK,EAAI;AACP,MAAIA,KAAK,CAACD,QAAV,EAAoB;AAChB,YAAQC,KAAK,CAACD,QAAN,CAAeE,MAAvB;AACI,WAAK,GAAL;AACI;AACAC,QAAAA,cAAc,CAACC,UAAf,CAA0B,OAA1B;;AACAT,0BAAQU,MAAR,CAAe,QAAf,EAHJ,CAII;AACA;AACA;AACA;;;AACAC,8BAAWC,KAAX,CAAiB,eAAjB,EAAiC,MAAjC,EAAwC;AACtCC,UAAAA,iBAAiB,EAAC,QADoB;AAEtCC,UAAAA,QAAQ,EAAC,kBAAAC,MAAM,EAAI;AACjBC,YAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB,GAArB;AACD;AAJqC,SAAxC;;AAMJ,WAAK,GAAL;AACI;AACA;AACA;AACA;AACA;AACAP,8BAAWC,KAAX,CAAiB,YAAjB,EAA8B,MAA9B,EAAqC;AACnCC,UAAAA,iBAAiB,EAAC,IADiB;AAEnCC,UAAAA,QAAQ,EAAC,kBAAAC,MAAM,EAAI;AACjBI,YAAAA,OAAO,CAACC,EAAR,CAAW,CAAX;AACD;AAJkC,SAArC;;AArBR;AA4BH;;AACD,SAAOjB,OAAO,CAACC,MAAR,CAAeE,KAAK,CAACD,QAAN,CAAetB,IAA9B,CAAP,CA/BO,CA+BuC;AAC/C,CApCH;AAwCA;;;;;;;;AAMO,SAASsC,KAAT,CAAeC,GAAf,EAAiC;AAAA,MAAb5C,MAAa,uEAAJ,EAAI;AAEpC,SAAO,IAAIyB,OAAJ,CAAY,UAACoB,OAAD,EAAUnB,MAAV,EAAqB;AACpCzB,mBAAMC,GAAN,CAAU0C,GAAV,EAAe;AACX5C,MAAAA,MAAM,EAAEA;AADG,KAAf,EAGCG,IAHD,CAGM,UAAAwB,QAAQ,EAAI;AACdkB,MAAAA,OAAO,CAAClB,QAAQ,CAACtB,IAAV,CAAP;AACH,KALD,EAMCyC,KAND,CAMO,UAAAtB,GAAG,EAAI;AACVE,MAAAA,MAAM,CAACF,GAAD,CAAN;AACH,KARD;AASH,GAVM,CAAP;AAWH;AAED;;;;;;;;AAMO,SAASb,IAAT,CAAciC,GAAd,EAA8B;AAAA,MAAXvC,IAAW,uEAAJ,EAAI;AACjC,SAAO,IAAIoB,OAAJ,CAAY,UAACoB,OAAD,EAAUnB,MAAV,EAAqB;AACpCzB,mBAAMU,IAAN,CAAWiC,GAAX,EAAgBvC,IAAhB,EACKF,IADL,CACU,UAAAwB,QAAQ,EAAI;AACdkB,MAAAA,OAAO,CAAClB,QAAQ,CAACtB,IAAV,CAAP;AACH,KAHL,EAGO,UAAAmB,GAAG,EAAI;AACNE,MAAAA,MAAM,CAACF,GAAD,CAAN;AACH,KALL;AAMH,GAPM,CAAP;AAQH;AAED;;;;;;;;AAMO,SAASuB,KAAT,CAAeH,GAAf,EAA+B;AAAA,MAAXvC,IAAW,uEAAJ,EAAI;AAClC,SAAO,IAAIoB,OAAJ,CAAY,UAACoB,OAAD,EAAUnB,MAAV,EAAqB;AACpCzB,mBAAM8C,KAAN,CAAYH,GAAZ,EAAiBvC,IAAjB,EACKF,IADL,CACU,UAAAwB,QAAQ,EAAI;AACdkB,MAAAA,OAAO,CAAClB,QAAQ,CAACtB,IAAV,CAAP;AACH,KAHL,EAGO,UAAAmB,GAAG,EAAI;AACNE,MAAAA,MAAM,CAACF,GAAD,CAAN;AACH,KALL;AAMH,GAPM,CAAP;AAQH;AAED;;;;;;;;AAMO,SAASwB,GAAT,CAAaJ,GAAb,EAA6B;AAAA,MAAXvC,IAAW,uEAAJ,EAAI;AAChC,SAAO,IAAIoB,OAAJ,CAAY,UAACoB,OAAD,EAAUnB,MAAV,EAAqB;AACpCzB,mBAAM+C,GAAN,CAAUJ,GAAV,EAAevC,IAAf,EACKF,IADL,CACU,UAAAwB,QAAQ,EAAI;AACdkB,MAAAA,OAAO,CAAClB,QAAQ,CAACtB,IAAV,CAAP;AACH,KAHL,EAGO,UAAAmB,GAAG,EAAI;AACNE,MAAAA,MAAM,CAACF,GAAD,CAAN;AACH,KALL;AAMH,GAPM,CAAP;AAQH","sourcesContent":["import axios from 'axios';\nimport router from 'vue-router'\nimport Cookies from 'js-cookie'\nimport {MessageBox} from 'element-ui';\nexport const test = 'http://127.0.0.1:8092';\n//export const test = 'http://apitest.jyblife.com';\n\nexport const requestLogout = params => { return axios.get(`${test}/api/user/logout`, params).then(res => res.data); };\n// 获取全局配置列表\nexport const getProjectConfig = (headers, params) => {\n    return axios.get(`${test}/api/project/config_list`, { params: params, headers:headers}).then(res => res.data); };\n// 获取全局配置列表\nexport const getGlobalPublish = (headers, params) => {\n    return axios.get(`${test}/api/global/publish_list`, { params: params, headers:headers}).then(res => res.data); };\n// 获取项目动态\nexport const getProjectDynamicList = (headers, params) => {\n    return axios.get(`${test}/api/dynamic/dynamic`, { params: params, headers:headers}).then(res => res.data); };\n// 运行自动化用例\nexport const runAutomation = (headers,params) => {\n    return axios.post(`${test}/api/automation/run`, params, {headers}).then(res => res.data); };\n\n// 默认超时设置\naxios.defaults.timeout = 10000;\n// 相对路径设置\naxios.defaults.baseURL ='';\naxios.defaults.crossDomain = true;\naxios.defaults.withCredentials  = true;\n//http request 拦截器\naxios.interceptors.request.use(\n  config => {\n    // 获取token\n    const ticket = Cookies.get('ticket');\n    // 添加token到headers\n    if(ticket){\n      config.headers.Authorization = ticket;\n    }\n    ////参数处理\n    //if(config.method === 'get' && config.url !== '/api/user/login'){\n    //  config.params = config.params;\n    //}else if(config.url !== '/api/user/login'){\n    //  config.data = config.data || {};\n    //  config.params = config.params || {'ticket': ticket};\n    //}\n    return config;\n  },\n  err => {\n    return Promise.reject(err);\n  }\n);\n\n\n//http response 拦截器\naxios.interceptors.response.use(\n  response => {\n    return response;\n  },\n  error => {\n    if (error.response) {\n        switch (error.response.status) {\n            case 403:\n                // 返回 401 清除token信息并跳转到登录页面\n                sessionStorage.removeItem('token');\n                Cookies.remove('ticket');\n                //router.replace({\n                //    path: 'login',\n                //    query: {redirect: router.currentRoute.fullPath}\n                //});\n                MessageBox.alert(\"登录信息超时,请重新登录!\",\"登录超时\",{\n                  confirmButtonText:\"跳转登录页面\",\n                  callback:action => {\n                    window.location.href=\"/\";\n                  }\n                });\n            case 406:\n                // 返回 401 清除token信息并跳转到登录页面\n                //router.replace({\n                //    path: 'login',\n                //    query: {redirect: router.currentRoute.fullPath}\n                //});\n                MessageBox.alert(\"没有权限执行该操作!\",\"没有权限\",{\n                  confirmButtonText:\"关闭\",\n                  callback:action => {\n                    history.go(0);\n                  }\n                });\n        }\n    }\n    return Promise.reject(error.response.data);   // 返回接口返回的错误信息\n  }\n);\n\n\n/**\n * fetch 请求方法\n * @param url\n * @param params\n * @returns {Promise}\n */\nexport function fetch(url, params = {}) {\n\n    return new Promise((resolve, reject) => {\n        axios.get(url, {\n            params: params\n        })\n        .then(response => {\n            resolve(response.data);\n        })\n        .catch(err => {\n            reject(err)\n        })\n    })\n}\n\n/**\n * post 请求方法\n * @param url\n * @param data\n * @returns {Promise}\n */\nexport function post(url, data = {}) {\n    return new Promise((resolve, reject) => {\n        axios.post(url, data)\n            .then(response => {\n                resolve(response.data);\n            }, err => {\n                reject(err);\n            })\n    })\n}\n\n/**\n * patch 方法封装\n * @param url\n * @param data\n * @returns {Promise}\n */\nexport function patch(url, data = {}) {\n    return new Promise((resolve, reject) => {\n        axios.patch(url, data)\n            .then(response => {\n                resolve(response.data);\n            }, err => {\n                reject(err);\n            })\n    })\n}\n\n/**\n * put 方法封装\n * @param url\n * @param data\n * @returns {Promise}\n */\nexport function put(url, data = {}) {\n    return new Promise((resolve, reject) => {\n        axios.put(url, data)\n            .then(response => {\n                resolve(response.data);\n            }, err => {\n                reject(err);\n            })\n    })\n}\n"]}]}