{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-1f91c8db\"],{4928:function(t,e,a){t.exports=a.p+\"static/img/icon-yes.d2f9f035.svg\"},\"60be\":function(t,e,a){t.exports=a.p+\"static/img/icon-no.439e8214.svg\"},\"8f52\":function(t,e,a){\"use strict\";a.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o(\"section\",[o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:(\"case\"===t.currentType||\"reuse\"===t.currentType)&&\"update\"===t.pageType,expression:\"(currentType==='case'||currentType==='reuse')&&pageType==='update'\"}],attrs:{type:\"primary\"},nativeOn:{click:function(e){return t.handleAdd(e)}}},[t._v(\"添加步骤\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:(\"case\"===t.currentType||\"reuse\"===t.currentType)&&\"update\"===t.pageType,expression:\"(currentType==='case'||currentType==='reuse')&&pageType==='update'\"}],attrs:{type:\"primary\"},nativeOn:{click:function(e){return t.handleAddReuse(e)}}},[t._v(\"添加可重用步骤\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"monitor\"===t.currentType&&\"update\"===t.pageType,expression:\"currentType==='monitor'&&pageType==='update'\"}],attrs:{type:\"primary\"},on:{click:t.handleLinkApi}},[t._v(\"关联接口\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"list\"===t.currentType&&\"update\"===t.pageType,expression:\"currentType==='list'&&pageType==='update'\"}],attrs:{type:\"primary\"},on:{click:t.handleLinkAutomation}},[t._v(\"关联自动化\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType,expression:\"pageType!=='update'\"}],attrs:{type:\"primary\",disabled:t.running},on:{click:function(e){return t.RunAutomation(t.ids)}}},[o(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.running,expression:\"!running\"}]},[t._v(\"执行\")]),t._v(\" \"),o(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.running,expression:\"running\"}]},[t._v(\"执行中\")])]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType&&(\"list\"===t.currentType||\"monitor\"===t.currentType)&&t.failRerunShow,expression:\"pageType!=='update' && (currentType==='list'||currentType==='monitor') && failRerunShow\"}],attrs:{type:\"primary\",disabled:t.running},on:{click:function(e){return t.RunAutomation(t.failIds)}}},[o(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.running,expression:\"!running\"}]},[t._v(\"失败重跑\")]),t._v(\" \"),o(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.running,expression:\"running\"}]},[t._v(\"执行中\")])]),t._v(\" \"),o(\"el-select\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType,expression:\"pageType!=='update'\"}],attrs:{placeholder:\"执行环境\"},model:{value:t.env,callback:function(e){t.env=e},expression:\"env\"}},t._l(t.EnvList,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.name,value:t.name}})})),1),t._v(\" \"),o(\"el-select\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType,expression:\"pageType!=='update'\"}],attrs:{multiple:\"\",placeholder:\"测试数据\"},model:{value:t.data,callback:function(e){t.data=e},expression:\"data\"}},t._l(t.DataList,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.name,value:t.name}})})),1),t._v(\" \"),o(\"el-select\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType,expression:\"pageType!=='update'\"}],attrs:{placeholder:\"执行结果\"},on:{change:function(e){return t.getResult(t.result.resulttrace)}},model:{value:t.result.resulttrace,callback:function(e){t.$set(t.result,\"resulttrace\",e)},expression:\"result.resulttrace\"}},t._l(t.result.ResultList,(function(e,a){return o(\"el-option\",{key:a+\"\",style:t.result_color[e.result],attrs:{label:e.testTime,value:e.trace}})})),1),t._v(\" \"),o(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"更新自动化步骤\",params:{automation_id:this.$route.params.automation_id,type:\"update\"}}}},[o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"!==t.pageType,expression:\"pageType!=='update'\"}],staticClass:\"return-list\",staticStyle:{float:\"right\",\"margin-right\":\"15px\"},attrs:{type:\"primary\"}},[t._v(\"修改\")])],1),t._v(\" \"),o(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"自动化步骤列表\",params:{automation_id:this.$route.params.automation_id}}}},[o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType,expression:\"pageType==='update'\"}],staticClass:\"return-list\",staticStyle:{float:\"right\",\"margin-right\":\"15px\"},attrs:{type:\"primary\"}},[t._v(\"执行\")])],1),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType,expression:\"pageType==='update'\"}],staticClass:\"return-list\",staticStyle:{float:\"right\",\"margin-right\":\"15px\"},attrs:{type:\"primary\"},nativeOn:{click:function(e){return t.updateAutomation(e)}}},[t._v(\"保存\")]),t._v(\" \"),o(\"el-dialog\",{attrs:{title:\"选择可重用步骤\",visible:t.reuseSteps.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.reuseSteps,\"visible\",e)}}},[o(\"el-row\",{attrs:{gutter:10}},[o(\"el-col\",{attrs:{span:18}},[o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.reuseSteps.loading,expression:\"reuseSteps.loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.reuseSteps.list,\"highlight-current-row\":\"\",\"show-header\":!0,\"max-height\":\"400\"},on:{\"selection-change\":t.selStepsChange}},[o(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",sortable:\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"params\",label:\"参数\",\"min-width\":\"50%\",sortable:\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",sortable:\"\"}})],1)],1)],1),t._v(\" \"),o(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[o(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":t.reuseSteps.page,total:t.reuseSteps.total,\"page-size\":20,\"page-count\":t.reuseSteps.pages},on:{\"current-change\":t.handleCurrentChangeStep,\"update:currentPage\":function(e){return t.$set(t.reuseSteps,\"page\",e)},\"update:current-page\":function(e){return t.$set(t.reuseSteps,\"page\",e)}}})],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.reuseSteps.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\"},nativeOn:{click:function(e){return t.addReuseSteps(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{title:\"关联接口\",visible:t.linkApi.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.linkApi,\"visible\",e)}}},[o(\"el-row\",[o(\"el-input\",{attrs:{placeholder:\"名称,分组\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.getApiList(e)}},model:{value:t.linkApi.name,callback:function(e){t.$set(t.linkApi,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"linkApi.name\"}})],1),t._v(\" \"),o(\"el-row\",{attrs:{gutter:10}},[o(\"el-col\",{attrs:{span:24}},[o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.linkApi.loading,expression:\"linkApi.loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.linkApi.list,\"highlight-current-row\":\"\",\"show-header\":!0,\"max-height\":\"400\"},on:{\"selection-change\":t.selApisChange}},[o(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",sortable:\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"params\",label:\"参数\",\"min-width\":\"50%\",sortable:\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",sortable:\"\"}})],1)],1)],1),t._v(\" \"),o(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[o(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":t.linkApi.page,total:t.linkApi.total,\"page-size\":20,\"page-count\":t.linkApi.pages},on:{\"current-change\":t.handleCurrentChangeApi,\"update:currentPage\":function(e){return t.$set(t.linkApi,\"page\",e)},\"update:current-page\":function(e){return t.$set(t.linkApi,\"page\",e)}}})],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.linkApi.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\",loading:t.linkApi.loading},nativeOn:{click:function(e){return t.linkApiSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{title:\"关联用例\",visible:t.linkAutomation.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.linkAutomation,\"visible\",e)}}},[o(\"el-row\",[o(\"el-input\",{attrs:{placeholder:\"名称,分组\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.getAutomationList(e)}},model:{value:t.linkAutomation.name,callback:function(e){t.$set(t.linkAutomation,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"linkAutomation.name\"}})],1),t._v(\" \"),o(\"el-row\",{attrs:{gutter:10}},[o(\"el-col\",{attrs:{span:24}},[o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.linkAutomation.loading,expression:\"linkAutomation.loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.linkAutomation.list,\"highlight-current-row\":\"\",\"show-header\":!0,\"max-height\":\"400\"},on:{\"selection-change\":t.selAutomationsChange}},[o(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",sortable:\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",sortable:\"\"}})],1)],1)],1),t._v(\" \"),o(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[o(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":t.linkAutomation.page,total:t.linkAutomation.total,\"page-size\":20,\"page-count\":t.linkAutomation.pages},on:{\"current-change\":t.handleCurrentChangeAutomation,\"update:currentPage\":function(e){return t.$set(t.linkAutomation,\"page\",e)},\"update:current-page\":function(e){return t.$set(t.linkAutomation,\"page\",e)}}})],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.linkAutomation.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\",loading:t.linkAutomation.loading},nativeOn:{click:function(e){return t.linkAutomationSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-form\",{ref:\"automationForm\",attrs:{model:t.automationForm,rules:t.editFormRules,\"label-width\":\"80px\"}},[o(\"div\",{staticStyle:{border:\"1px solid #e6e6e6\",\"margin-bottom\":\"10px\",padding:\"15px\"}},[o(\"el-row\",{attrs:{gutter:10}},[o(\"el-col\",{attrs:{span:8}},[o(\"el-form-item\",{attrs:{label:\"名称\",prop:\"name\"}},[o(\"el-input\",{attrs:{disabled:\"update\"!==t.pageType,\"auto-complete\":\"off\"},model:{value:t.automationForm.name,callback:function(e){t.$set(t.automationForm,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"automationForm.name\"}})],1)],1),t._v(\" \"),o(\"el-col\",{attrs:{span:5}},[o(\"el-form-item\",{attrs:{label:\"类型\",\"label-width\":\"83px\",prop:\"type\"}},[o(\"el-select\",{attrs:{disabled:\"update\"!==t.pageType,placeholder:\"类型\"},model:{value:t.automationForm.type,callback:function(e){t.$set(t.automationForm,\"type\",e)},expression:\"automationForm.type\"}},t._l(t.automationType,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(\" \"),o(\"el-col\",{attrs:{span:8}},[o(\"el-form-item\",{attrs:{label:\"分组\",\"label-width\":\"83px\",prop:\"group\"}},[o(\"treeselect\",{attrs:{disabled:\"update\"!==t.pageType,options:t.group,placeholder:\"请选择\"},model:{value:t.automationForm.group,callback:function(e){t.$set(t.automationForm,\"group\",e)},expression:\"automationForm.group\"}})],1)],1)],1),t._v(\" \"),o(\"el-row\",{attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"参数\",prop:\"params\"}},[o(\"el-input\",{attrs:{type:\"textarea\",rows:2},model:{value:t.automationForm.params,callback:function(e){t.$set(t.automationForm,\"params\",\"string\"===typeof e?e.trim():e)},expression:\"automationForm.params\"}})],1)],1),t._v(\" \"),o(\"el-row\",{attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"描述\",prop:\"description\"}},[o(\"el-input\",{attrs:{disabled:\"update\"!==t.pageType,type:\"textarea\",rows:2},model:{value:t.automationForm.description,callback:function(e){t.$set(t.automationForm,\"description\",\"string\"===typeof e?e.trim():e)},expression:\"automationForm.description\"}})],1)],1)],1)]),t._v(\" \"),o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],staticClass:\"steptable\",staticStyle:{width:\"100%\"},attrs:{\"row-key\":\"index\",data:t.StepList,\"row-class-name\":t.getStepRowClass,\"highlight-current-row\":\"\"},on:{\"selection-change\":t.selsChange}},[o(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"5%\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{type:\"index\",\"min-width\":\"5%\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"30%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"monitor\"!==t.automationForm.type&&\"case\"!==e.row.type&&\"reuse\"!==e.row.type,expression:\"automationForm.type!=='monitor'&&scope.row.type!=='case'&&scope.row.type!=='reuse'\"}],staticStyle:{\"font-size\":\"16px\"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v(t._s(e.row.name))]),t._v(\" \"),o(\"router-link\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"case\"===e.row.type||\"reuse\"===e.row.type,expression:\"scope.row.type==='case'||scope.row.type==='reuse'\"}],staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"自动化步骤列表\",params:{automation_id:e.row.stepId}}}},[t._v(t._s(e.row.name))]),t._v(\" \"),o(\"router-link\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"monitor\"===t.automationForm.type,expression:\"automationForm.type==='monitor'\"}],staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"基础信息\",params:{api_id:e.row.id}}}},[t._v(t._s(e.row.name))])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.description))])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"result\",label:\"结果\",\"min-width\":\"10%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:!e.row.result||\"RUNNING\"===e.row.result,expression:\"!scope.row.result||scope.row.result==='RUNNING'\"}]},[t._v(\"未执行\")]),t._v(\" \"),\"case\"!==e.row.type&&\"reuse\"!==e.row.type||!e.row.result?t._e():o(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"自动化执行详情\",params:{project_id:t.project_id,automation_id:e.row.stepId,trace:e.row.trace}}}},[o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"PASS\"===e.row.result,expression:\"scope.row.result==='PASS'\"}],staticStyle:{color:\"#11b95c\",cursor:\"pointer\"}},[t._v(\"通过\")]),t._v(\" \"),o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"FAIL\"===e.row.result,expression:\"scope.row.result==='FAIL'\"}],staticStyle:{color:\"#cc0000\",cursor:\"pointer\"}},[t._v(\"失败\")])]),t._v(\" \"),o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"case\"!==e.row.type&&\"reuse\"!==e.row.type&&\"PASS\"===e.row.result,expression:\"(scope.row.type!=='case'&&scope.row.type!=='reuse')&&scope.row.result==='PASS'\"}],staticStyle:{color:\"#11b95c\",cursor:\"pointer\"},on:{click:function(a){return t.resultShow(e.row)}}},[t._v(\"通过\")]),t._v(\" \"),o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"case\"!==e.row.type&&\"reuse\"!==e.row.type&&\"FAIL\"===e.row.result,expression:\"(scope.row.type!=='case'&&scope.row.type!=='reuse')&&scope.row.result==='FAIL'\"}],staticStyle:{color:\"#cc0000\",cursor:\"pointer\"},on:{click:function(a){return t.resultShow(e.row)}}},[t._v(\"失败\")])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"status\",label:\"启用\",\"min-width\":\"10%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"img\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.row.status,expression:\"scope.row.status\"}],attrs:{src:a(\"4928\")}}),t._v(\" \"),o(\"img\",{directives:[{name:\"show\",rawName:\"v-show\",value:!e.row.status,expression:\"!scope.row.status\"}],attrs:{src:a(\"60be\")}})]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"30%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-dropdown\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType&&(\"case\"===t.automationForm.type||\"reuse\"===t.automationForm.type),expression:\"pageType==='update'&&(automationForm.type==='case'||automationForm.type==='reuse')\"}]},[o(\"el-button\",{attrs:{type:\"primary\",size:\"small\",plain:\"\"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v(\"修改\"),o(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),t._v(\" \"),o(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[o(\"el-dropdown-item\",[o(\"el-button\",{attrs:{type:\"primary\",size:\"small\",plain:\"\"},on:{click:function(a){return t.handleCopy(e.$index,e.row)}}},[t._v(\"复制\")])],1),t._v(\" \"),o(\"el-dropdown-item\",[o(\"el-button\",{attrs:{type:\"info\",size:\"small\",plain:\"\"},on:{click:function(a){return t.handleChangeStatus(e.$index,e.row)}}},[t._v(t._s(!1===e.row.status?\"启用\":\"禁用\"))])],1),t._v(\" \"),o(\"el-dropdown-item\",[o(\"el-button\",{attrs:{type:\"danger\",size:\"small\",plain:\"\"},on:{click:function(a){return t.handleDel(e.$index,e.row)}}},[t._v(\"删除\")])],1)],1)],1),t._v(\" \"),o(\"el-button-group\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType,expression:\"pageType==='update'\"}]},[o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"list\"===t.automationForm.type,expression:\"automationForm.type==='list'\"}],attrs:{type:\"info\",size:\"mini\"},on:{click:function(a){return t.handleChangeStatus(e.$index,e.row)}}},[t._v(t._s(!1===e.row.status?\"启用\":\"禁用\"))]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"monitor\"===t.automationForm.type,expression:\"automationForm.type==='monitor'\"}],attrs:{type:\"primary\",size:\"mini\"},on:{click:function(a){return t.handleUnlinkApi(e.$index,e.row)}}},[t._v(\"取消关联\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"list\"===t.automationForm.type,expression:\"automationForm.type==='list'\"}],attrs:{type:\"primary\",size:\"mini\"},on:{click:function(a){return t.handleUnlinkAutomation(e.$index,e.row)}}},[t._v(\"取消关联\")])],1)]}}])})],1),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType,expression:\"pageType==='update'\"}],staticClass:\"return-list\",staticStyle:{float:\"right\",\"margin-right\":\"15px\"},attrs:{type:\"primary\",disabled:t.updateOrderStatus},on:{click:function(e){return t.updateOrder()}}},[t._v(\"\\n        编辑步骤顺序\\n    \")]),t._v(\" \"),o(\"el-dialog\",{staticStyle:{width:\"100%\"},attrs:{width:\"80%\",title:t.editFormTitle,visible:t.editFormVisible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.editFormVisible=e},open:t.actiontableshow}},[o(\"el-form\",{ref:\"editForm\",attrs:{model:t.editForm,rules:t.editFormRules,\"label-width\":\"80px\"}},[o(\"el-form-item\",{attrs:{label:\"名称\",prop:\"name\"}},[o(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"editForm.name\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"类型:\",\"label-width\":\"83px\",prop:\"type\"}},[o(\"el-select\",{attrs:{placeholder:\"类型\"},model:{value:t.editForm.type,callback:function(e){t.$set(t.editForm,\"type\",e)},expression:\"editForm.type\"}},t._l(t.stepType,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"参数\",prop:\"params\"}},[o(\"el-input\",{attrs:{type:\"textarea\",rows:3},model:{value:t.editForm.params,callback:function(e){t.$set(t.editForm,\"params\",\"string\"===typeof e?e.trim():e)},expression:\"editForm.params\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"描述\",prop:\"description\"}},[o(\"el-input\",{attrs:{type:\"textarea\",rows:4},model:{value:t.editForm.description,callback:function(e){t.$set(t.editForm,\"description\",\"string\"===typeof e?e.trim():e)},expression:\"editForm.description\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"操作\",prop:\"steps\"}},[o(\"el-button\",{staticClass:\"el-icon-plus\",attrs:{size:\"mini\",title:\"添加\"},on:{click:function(e){return t.addCommand(0)}}}),t._v(\" \"),o(\"el-table\",{staticClass:\"actiontable\",attrs:{id:\"actiontable\",\"row-key\":\"name\",data:t.editForm.steps,\"highlight-current-row\":\"\"}},[o(\"el-table-column\",{attrs:{type:\"index\",\"min-width\":\"5%\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"30%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-select\",{staticStyle:{width:\"100%\"},attrs:{placeholder:\"步骤名称\",filterable:\"\"},on:{change:function(a){return t.changeCommand(e.$index)}},model:{value:e.row.name,callback:function(a){t.$set(e.row,\"name\",a)},expression:\"scope.row.name\"}},t._l(t.commands,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.alias,value:t.name}})})),1)]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"params\",label:\"参数\",\"min-width\":\"35%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-input\",{attrs:{type:\"textarea\",rows:2,value:e.row.params,placeholder:\"请输入内容\"},model:{value:e.row.params,callback:function(a){t.$set(e.row,\"params\",\"string\"===typeof a?a.trim():a)},expression:\"scope.row.params\"}})]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{label:\"描述\",\"min-width\":\"20%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-input\",{attrs:{type:\"textarea\",rows:2,value:e.row.description,placeholder:\"请输入内容\"},model:{value:e.row.description,callback:function(a){t.$set(e.row,\"description\",\"string\"===typeof a?a.trim():a)},expression:\"scope.row.description\"}})]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"20%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-button-group\",[o(\"el-button\",{staticClass:\"el-icon-minus\",attrs:{size:\"mini\",title:\"删除\"},on:{click:function(a){return t.delCommand(e.$index)}}}),t._v(\" \"),o(\"el-button\",{staticClass:\"el-icon-plus\",attrs:{size:\"mini\",title:\"添加\"},on:{click:function(a){return t.addCommand(e.$index)}}}),t._v(\" \"),o(\"router-link\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"===e.row.type,expression:\"scope.row.type==='api'\"}],staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"基础信息\",params:{api_id:e.row.actionId}}}},[o(\"el-button\",{staticClass:\"el-icon-view\",attrs:{title:\"查看接口\",size:\"mini\"}})],1),t._v(\" \"),o(\"router-link\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"automation\"===e.row.type,expression:\"scope.row.type==='automation'\"}],staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"自动化步骤列表\",params:{automation_id:e.row.actionId}}}},[o(\"el-button\",{staticClass:\"el-icon-view\",attrs:{title:\"查看用例\",size:\"mini\"}})],1)],1)]}}])})],1)],1)],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"update\"===t.pageType,expression:\"pageType==='update'\"}],attrs:{type:\"primary\",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{width:\"60%\",title:t.StepResultName,visible:t.AutomationResult,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.AutomationResult=e}}},[o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.StepResultDetails,\"max-height\":\"400\",\"highlight-current-row\":\"\"}},[o(\"el-table-column\",{attrs:{type:\"expand\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-form\",{staticClass:\"demo-table-expand\",attrs:{\"label-position\":\"left\",inline:\"\"}},[o(\"el-table\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"automation\"===e.row.type,expression:\"props.row.type==='automation'\"},{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.row.details,\"highlight-current-row\":\"\"}},[o(\"el-table-column\",{attrs:{type:\"index\",width:\"55\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.name))])]}}],null,!0)}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"result\",label:\"结果\",\"min-width\":\"40%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.result))])]}}],null,!0)}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"status\",label:\"状态\",\"min-width\":\"10%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"PASS\"===e.row.status,expression:\"scope.row.status==='PASS'\"}],staticStyle:{color:\"#11b95c\",cursor:\"pointer\"}},[t._v(\"成功\")]),t._v(\" \"),o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"FAIL\"===e.row.status,expression:\"scope.row.status==='FAIL'\"}],staticStyle:{color:\"#cc0000\",cursor:\"pointer\"}},[t._v(\"失败\")])]}}],null,!0)}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.description))])]}}],null,!0)})],1),t._v(\" \"),o(\"el-row\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"===e.row.type,expression:\"props.row.type==='api'\"}],attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"接口地址： \"}},[o(\"span\",[t._v(t._s(e.row.url))])])],1),t._v(\" \"),o(\"el-row\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"===e.row.type,expression:\"props.row.type==='api'\"}],attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"请求方式： \"}},[o(\"span\",[t._v(t._s(e.row.method))])])],1),t._v(\" \"),o(\"el-row\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"===e.row.type,expression:\"props.row.type==='api'\"}],attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"请求参数： \"}},[o(\"span\",{staticStyle:{\"word-break\":\"break-all\",overflow:\"auto\",\"overflow-x\":\"hidden\"}},[t._v(t._s(e.row.data))])])],1),t._v(\" \"),o(\"el-row\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"automation\"!==e.row.type,expression:\"props.row.type!=='automation'\"}],attrs:{gutter:10}},[o(\"el-form-item\",{attrs:{label:\"返回结果： \"}},[o(\"span\",[o(\"code\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"!==e.row.type,expression:\"props.row.type!=='api'\"}]},[t._v(t._s(e.row.result))]),t._v(\" \"),o(\"json-viewer\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"api\"===e.row.type,expression:\"props.row.type==='api'\"}],attrs:{value:e.row.result,\"expand-depth\":5,boxed:\"\",copyable:\"\"}})],1)])],1)],1)]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{type:\"index\",width:\"55\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.name))])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"result\",label:\"结果\",\"min-width\":\"40%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.result))])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"status\",label:\"状态\",\"min-width\":\"10%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"PASS\"===e.row.status,expression:\"scope.row.status==='PASS'\"}],staticStyle:{color:\"#11b95c\",cursor:\"pointer\"}},[t._v(\"成功\")]),t._v(\" \"),o(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"FAIL\"===e.row.status,expression:\"scope.row.status==='FAIL'\"}],staticStyle:{color:\"#cc0000\",cursor:\"pointer\"}},[t._v(\"失败\")])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"30%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"span\",{staticStyle:{\"font-size\":\"16px\"}},[t._v(t._s(e.row.description))])]}}])})],1)],1)],1)},i=[],s=(a(\"c5f6\"),a(\"7f7f\"),a(\"ac6a\"),a(\"bd86\")),n=a(\"ca17\"),r=a.n(n),l=(a(\"542c\"),a(\"4ec3\")),p=a(\"53fe\"),u=a.n(p),c=(a(\"1157\"),a(\"c1df\"),a(\"bc3a\")),m=a.n(c),d={components:{Treeselect:r.a},data:function(){var t;return t={automationType:[{value:\"case\",label:\"普通用例\"},{value:\"reuse\",label:\"可复用用例\"},{value:\"list\",label:\"用例集\"},{value:\"data\",label:\"数据用例\"},{value:\"monitor\",label:\"接口监控\"}],currentType:\"\",result_color:{PASS:\"color:green\",FAIL:\"color:red\"},stepType:[{value:\"normal\",label:\"普通\"},{value:\"project\",label:\"项目\"},{value:\"global\",label:\"全局\"}],project:\"\",automation:\"\",StepList:[],stepIds:[],failIds:[],failRerunShow:!1,ids:[],listLoading:!1,running:!1,updateOrderStatus:!1,searchName:\"\",total:0,page:1,env:\"\",data:\"\",group:[],EnvList:[],DataList:[],commands:{},groupData:[],sels:[],AutomationResult:!1,StepResultDetails:[],StepResultName:\"\",result:{},StepListLen:\"\",StepListIndex:0,activeIndex:\"\",editFormVisible:!1,editFormTitle:\"\",editLoading:!1,editFormRules:{name:[{required:!0,message:\"请输入名称\",trigger:\"blur\"},{min:1,max:1024,message:\"长度在 1 到 1024 个字符\",trigger:\"blur\"}],type:[{required:!0,message:\"请选择类型\",trigger:\"blur\"}],description:[{required:!1,message:\"请输入描述\",trigger:\"blur\"},{max:1024,message:\"不能超过1024个字符\",trigger:\"blur\"}]},editForm:{name:\"\",params:\"{}\",steps:[],description:\"\",type:\"normal\",order:\"\"},addForm:{name:\"\",params:\"{}\",steps:[{type:\"\",name:\"\",actionId:0,params:\"{}\",description:\"\",disable:\"False\"}],description:\"\",type:\"normal\",order:\"\"},automationForm:{name:\"\",type:\"\",group:null,params:\"{}\",description:\"\",id:\"\"},linkAutomation:{visible:!1,loading:!1,list:[],page:1,pages:0,total:0,selAutomations:[]},linkApi:{visible:!1,loading:!1,list:[],page:1,pages:0,total:0,selApis:[]},reuseSteps:{visible:!1,loading:!1,list:[],total:0,page:1,pages:0,selSteps:[]}},Object(s[\"a\"])(t,\"result\",{resulttrace:\"\",ResultList:[]}),Object(s[\"a\"])(t,\"getResultTimer\",\"\"),Object(s[\"a\"])(t,\"getResultTimes\",0),Object(s[\"a\"])(t,\"project_id\",this.$route.params.project_id),Object(s[\"a\"])(t,\"pageType\",\"\"),t},methods:{selsChange:function(t){\"monitor\"==this.automationForm.type?this.ids=t.map((function(t){return t.id})):this.ids=t.map((function(t){return t.stepId}))},getStepRowClass:function(t){var e=t.row;return e.status?\"\":\"disable-step\"},handleSelect:function(t,e){this.activeIndex=t,console.log(this.activeIndex)},getAutomationGroupAndInfo:function(){var t=this;m.a.get(l[\"f\"]+\"/api/automation/group\",{params:{project_id:this.$route.params.project_id}}).then((function(e){\"999999\"===e.data.code?t.group=e.data.data:t.$message.error({message:e.data.msg,center:!0}),t.getAutomationStepList()})).catch((function(t){}))},getAutomationStepList:function(){this.listLoading=!0;var t=this,e={project_id:this.$route.params.project_id,page:t.page,name:t.searchName,automation_id:this.$route.params.automation_id};m.a.get(l[\"f\"]+\"/api/automation/step_list\",{params:e}).then((function(e){t.listLoading=!1,t.stepIds=[],\"999999\"===e.data.code?(t.currentType=e.data.data.automation.type,t.StepList=[],t.result.ResultList=[],t.automationForm=e.data.data.automation,t.automationForm.group=e.data.data.automation.group,e.data.data.steps.forEach((function(a){a.result=!1,t.StepList.push(a),\"list\"==e.data.data.automation.type?t.stepIds.push(a.stepId):\"monitor\"==e.data.data.automation.type&&t.stepIds.push(a.id)})),e.data.data.results.forEach((function(e){t.result.ResultList.push(e)}))):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},getCommandList:function(){this.listLoading=!0;var t=this;m.a.get(l[\"f\"]+\"/api/automation/command_list\",{params:{project_id:this.$route.params.project_id,automation_id:this.$route.params.automation_id}}).then((function(e){t.listLoading=!1,\"999999\"===e.data.code?(t.commands={},e.data.data.data.forEach((function(e){t.commands[e.name]=e}))):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},getResult:function(t){var e=this,a={project_id:this.$route.params.project_id,automation_id:this.$route.params.automation_id,trace:t};e.running||e.StepList.forEach((function(t,e){t.testtime=\"\",t.result=null,t.details=[]})),m.a.get(l[\"f\"]+\"/api/automation/getresult\",{params:a}).then((function(t){e.getResultTimes++,\"999999\"===t.data.code?(e.failIds=[],t.data.data.details.forEach((function(t,a){e.StepList.forEach((function(a,o){((\"step\"==t.type||\"automation\"==t.type)&&t[\"id\"]==a[\"stepId\"]||\"api\"==t.type&&t[\"id\"]==a[\"id\"])&&(a.result=t.status,a.testtime=t.testtime,a.details=t.details,a.trace=t.trace,\"FAIL\"!=t.status||\"api\"!=t[\"type\"]&&\"automation\"!=t[\"type\"]||e.failIds.push(t[\"id\"]))}))})),(\"RUNNING\"!=t.data.data.status||e.getResultTimes>100)&&(e.getResultTimes=0,clearInterval(e.getResultTimer),e.running=!1,e.failIds.length>0?e.failRerunShow=!0:e.failRerunShow=!1)):e.$message.error({message:\"获取失败\",center:!0})})).catch((function(t){}))},StepTotal:function(){this.StepListLen=this.StepList.length},handleLinkApi:function(){this.linkApi.visible=!0,this.linkApi.page=1,this.getApiList()},getApiList:function(){var t=this;t.linkApi.loading=!0;var e={project_id:this.$route.params.project_id,page:t.linkApi.page,name:t.linkApi.name,exclude:JSON.stringify(t.stepIds)};m.a.get(l[\"f\"]+\"/api/api/api_list\",{params:e}).then((function(e){t.linkApi.loading=!1,\"999999\"===e.data.code?(t.linkApi.list=e.data.data.data,t.linkApi.total=e.data.data.total,t.linkApi.pages=e.data.data.pages):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},handleUnlinkApi:function(t,e){var a=this;this.$confirm(\"确认取消关联接口[\"+e.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var t=a,o=JSON.stringify({project_id:Number(a.$route.params.project_id),automation_id:Number(a.$route.params.automation_id),ids:[e.id]}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/unlink_api\",o,{headers:i}).then((function(e){t.listLoading=!1,\"999999\"===e.data.code?t.$message({message:\"取消关联成功\",center:!0,type:\"success\"}):t.$message.error({message:e.data.msg,center:!0}),t.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},handleUnlinkAutomation:function(t,e){var a=this;this.$confirm(\"确认取消关联用例[\"+e.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var t=a,o=JSON.stringify({project_id:Number(a.$route.params.project_id),automation_id:Number(a.$route.params.automation_id),ids:[e.stepId]}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/unlink_automation\",o,{headers:i}).then((function(e){t.listLoading=!1,\"999999\"===e.data.code?t.$message({message:\"取消关联成功\",center:!0,type:\"success\"}):t.$message.error({message:e.data.msg,center:!0}),t.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},handleChangeStatus:function(t,e){var a=this;this.listLoading=!0;var o={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")},i={project_id:Number(this.$route.params.project_id),id:e.id,status:!e.status,type:e.type},s=\"禁用成功\";e.status||(s=\"启用成功\"),m.a.post(l[\"f\"]+\"/api/automation/stepstatus_update\",i,{headers:o}).then((function(t){a.listLoading=!1,\"999999\"===t.data.code?(a.$message({message:s,center:!0,type:\"success\"}),e.status=!e.status):a.$message.error({message:t.data.msg,center:!0})})).catch((function(t){}))},linkApiSubmit:function(){var t=this,e=this.linkApi.selApis.map((function(t){return t.id})),a=this;this.$confirm(\"确认关联选中的接口吗？\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),automation_id:Number(t.$route.params.automation_id),ids:e}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/link_api\",o,{headers:i}).then((function(t){a.listLoading=!1,\"999999\"===t.data.code?a.$message({message:\"关联成功\",center:!0,type:\"success\"}):a.$message.error({message:t.data.msg,center:!0}),a.linkApi.visible=!1,a.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},getAutomationList:function(){var t=this;t.linkAutomation.loading=!0;var e={project_id:this.$route.params.project_id,type:\"case\",page:t.linkAutomation.page,exclude:JSON.stringify(t.stepIds)};\"\"!=this.linkAutomation.name&&(e[\"name\"]=this.linkAutomation.name);var a={Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.get(l[\"f\"]+\"/api/automation/automation_list\",{params:e,headers:a}).then((function(e){t.linkAutomation.loading=!1,\"999999\"===e.data.code?(t.linkAutomation.list=e.data.data.data,t.linkAutomation.total=e.data.data.total,t.linkAutomation.pages=e.data.data.pages):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},handleLinkAutomation:function(){this.linkAutomation.visible=!0,this.linkAutomation.page=1,this.getAutomationList()},linkAutomationSubmit:function(){var t=this,e=this.linkAutomation.selAutomations.map((function(t){return t.id})),a=this;this.$confirm(\"确认关联选中的用例吗？\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),automation_id:Number(t.$route.params.automation_id),ids:e}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/link_automation\",o,{headers:i}).then((function(t){a.listLoading=!1,\"999999\"===t.data.code?a.$message({message:\"关联成功\",center:!0,type:\"success\"}):a.$message.error({message:t.data.msg,center:!0}),a.linkAutomation.visible=!1,a.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},RunAutomation:function(t){if(this.env){var e=this,a={project_id:Number(this.$route.params.project_id),automation_id:Number(this.$route.params.automation_id),params:this.automationForm.params,env:this.env,data:this.data};t&&t.length>0&&(a[\"ids\"]=t);var o={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};Object(l[\"e\"])(o,a).then((function(t){\"999999\"===t.code?(e.$message({message:\"开始执行\",center:!0,type:\"success\"}),e.StepList.forEach((function(t,e){t.testtime=\"\",t.result=null,t.details=[]})),e.result.ResultList.splice(0,0,{testTime:t.data.testtime,trace:t.data.trace,result:t.data.status}),\"RUNNING\"==t.data.status&&(e.running=!0,e.getResultTimes=0,e.getResultTimer=setInterval((function(){e.getResult(t.data.trace)}),3e3))):e.$message.error({message:t.msg,center:!0})}))}else this.$message({message:\"请选择测试环境\",center:!0,type:\"warning\"})},handleDel:function(t,e){var a=this;this.$confirm(\"确认删除步骤[\"+e.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var o=a,i=JSON.stringify({project_id:Number(a.$route.params.project_id),automation_id:Number(a.$route.params.automation_id),ids:[{order:t+1,id:e.stepId}]}),s={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/del_step\",i,{headers:s}).then((function(t){o.listLoading=!1,\"999999\"===t.data.code?o.$message({message:\"删除成功\",center:!0,type:\"success\"}):o.$message.error({message:t.data.msg,center:!0}),o.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},resultShow:function(t){this.AutomationResult=!0,this.StepResultDetails=t.details,this.StepResultName=t.name},handleCurrentChangeStep:function(t){this.reuseSteps.page=t,this.getReuseStepList()},handleCurrentChangeAutomation:function(t){this.linkAutomation.page=t,this.getAutomationList()},handleCurrentChangeApi:function(t){this.linkApi.page=t,this.getApiList()},selStepsChange:function(t){this.reuseSteps.selSteps=t},selApisChange:function(t){this.linkApi.selApis=t},selAutomationsChange:function(t){this.linkAutomation.selAutomations=t},addReuseSteps:function(){var t=this,e=this.reuseSteps.selSteps.map((function(t){return t.id})),a=this;this.$confirm(\"确认添加选中的步骤吗？\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),automation_id:Number(t.$route.params.automation_id),ids:e}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/add_reuse_steps\",o,{headers:i}).then((function(t){a.listLoading=!1,\"999999\"===t.data.code?a.$message({message:\"添加成功\",center:!0,type:\"success\"}):a.$message.error({message:t.data.msg,center:!0}),a.reuseSteps.visible=!1,a.getAutomationStepList()})).catch((function(t){}))})).catch((function(){}))},getEnv:function(){var t=this,e={Authorization:\"Token \"+sessionStorage.getItem(\"token\")};Object(l[\"b\"])(e,{project_id:t.$route.params.project_id,page:t.page,name:\"\",type:\"env\"}).then((function(e){\"999999\"===e.code?(t.EnvList=[],e.data.data.forEach((function(e){e.status&&t.EnvList.push(e)}))):t.$message.error({message:e.msg,center:!0})}))},getData:function(){var t=this,e={Authorization:\"Token \"+sessionStorage.getItem(\"token\")};Object(l[\"b\"])(e,{project_id:this.$route.params.project_id,page:t.page,name:\"\",type:\"data\"}).then((function(e){\"999999\"===e.code?(t.DataList=[],e.data.data.forEach((function(e){e.status&&t.DataList.push(e)}))):t.$message.error({message:e.msg,center:!0})}))},handleEdit:function(t,e){this.editFormVisible=!0,\"update\"==this.pageType?this.editFormTitle=\"修改步骤\":this.editFormTitle=\"查看步骤\",this.editForm={id:e.stepId,name:e.name,type:e.type,params:e.params,steps:JSON.parse(e.steps),description:e.description},this.editForm.order=t+1},actiontableshow:function(){var t=this,e=document.querySelector(\".actiontable .el-table__body-wrapper tbody\");null!=e&&u.a.create(e,{onEnd:function(e){var a=e.newIndex,o=e.oldIndex,i=t.editForm.steps.splice(o,1)[0];t.editForm.steps.splice(a,0,i)}})},handleCopy:function(t,e){this.editFormVisible=!0,this.editFormTitle=\"复制步骤\",this.editForm={name:e.name,type:e.type,params:e.params,steps:JSON.parse(e.steps),description:e.description},this.editForm.order=this.StepList.length+1},handleAdd:function(){this.editFormVisible=!0,this.editFormTitle=\"添加步骤\",this.editForm=this.addForm,this.editForm.order=this.StepList.length+1},handleAddReuse:function(){this.reuseSteps.visible=!0,this.reuseSteps.page=1,this.getReuseStepList()},getReuseStepList:function(){var t=this,e={project_id:this.$route.params.project_id,page:t.reuseSteps.page},a={Authorization:\"Token \"+sessionStorage.getItem(\"token\")};t.reuseSteps.loading=!0,m.a.get(l[\"f\"]+\"/api/automation/step_list\",{params:e,headers:a}).then((function(e){t.reuseSteps.loading=!1,\"999999\"===e.data.code?(t.reuseSteps.list=e.data.data.data,t.reuseSteps.total=e.data.data.total,t.reuseSteps.pages=e.data.data.pages):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},editSubmit:function(){var t=this;if(null==this.editForm.id)this.addSubmit();else{var e=this,a=this.editForm.steps;1==a.length&&\"\"==a[0][\"name\"]&&(a=[]),this.$refs.editForm.validate((function(o){o&&t.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){e.editLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),automation_id:Number(t.$route.params.automation_id),id:Number(e.editForm.id),type:e.editForm.type,name:e.editForm.name,params:e.editForm.params,steps:JSON.stringify(a),description:e.editForm.description,order:e.editForm.order}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/update_step\",o,{headers:i}).then((function(t){e.editLoading=!1,\"999999\"===t.data.code?(e.$message({message:\"修改成功\",center:!0,type:\"success\"}),e.$refs[\"editForm\"].resetFields(),e.editFormVisible=!1,e.getAutomationStepList()):(t.data.code,e.$message.error({message:t.data.msg,center:!0}))})).catch((function(t){}))})).catch((function(){}))}))}},addSubmit:function(){var t=this;this.$refs.editForm.validate((function(e){if(e){var a=t,o=t.editForm.steps;1==o.length&&\"\"==o[0][\"name\"]&&(o=[]),t.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){a.editLoading=!0;var e=JSON.stringify({project_id:Number(t.$route.params.project_id),type:t.editForm.type,automation_id:Number(t.$route.params.automation_id),name:a.editForm.name,params:a.editForm.params,steps:JSON.stringify(o),description:a.editForm.description,order:a.editForm.order}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/add_step\",e,{headers:i}).then((function(t){a.editLoading=!1,\"999999\"===t.data.code?(a.$message({message:\"添加成功\",center:!0,type:\"success\"}),a.$refs[\"editForm\"].resetFields(),a.editFormVisible=!1,a.getAutomationStepList()):\"999997\"===t.data.code?a.$message.error({message:t.data.msg,center:!0}):(a.$message.error({message:t.data.msg,center:!0}),a.$refs[\"editForm\"].resetFields(),a.editFormVisible=!1,a.getAutomationStepList())})).catch((function(t){}))})).catch((function(){}))}}))},updateAutomation:function(){var t=this,e=this;this.$refs.automationForm.validate((function(a){if(a){var o=[];t.StepList.forEach((function(t){o.push(t[\"id\"])}));var i=JSON.stringify({project_id:Number(t.$route.params.project_id),id:Number(e.automationForm.id),type:e.automationForm.type,name:e.automationForm.name,params:e.automationForm.params,group_id:Number(t.automationForm.group),description:e.automationForm.description,orders:o}),s={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(l[\"f\"]+\"/api/automation/update_automation\",i,{headers:s}).then((function(t){\"999999\"===t.data.code?e.$message({message:\"保存成功\",center:!0,type:\"success\"}):e.$message.error({message:t.data.msg,center:!0})})).catch((function(t){}))}}))},addCommand:function(t){this.editForm.steps.splice(t+1,0,{type:\"\",name:\"\",actionId:0,params:\"{}\",description:\"\",disable:\"False\"})},delCommand:function(t){this.editForm.steps.splice(t,1)},changeCommand:function(t){var e=this.commands[this.editForm.steps[t].name];this.editForm.steps[t].name=e.name,this.editForm.steps[t].type=e.type,this.editForm.steps[t].actionId=e.actionId,this.editForm.steps[t].params=e.value,this.editForm.steps[t].description=e.desc},rowDrop:function(){try{var t=document.querySelector(\".steptable .el-table__body-wrapper tbody\"),e=this;u.a.create(t,{onEnd:function(t){var a=t.newIndex,o=t.oldIndex,i=e.StepList.splice(o,1)[0];e.StepList.splice(a,0,i)}})}catch(a){alert(a)}},updateOrder:function(){\"update\"==this.pageType&&this.rowDrop(),this.updateOrderStatus=!0},init:function(){this.pageType=this.$route.params.type,this.getAutomationGroupAndInfo(),\"update\"==this.pageType?this.getCommandList():(this.getEnv(),this.getData())}},mounted:function(){this.init()},watch:{$route:function(t,e){t.query!=e.query&&(this.reload(),\"update\"==this.pageType&&this.rowDrop())}}},h=d,g=(a(\"e9d7\"),a(\"2877\")),v=Object(g[\"a\"])(h,o,i,!1,null,\"08b63c72\",null);e[\"default\"]=v.exports},ae7e:function(t,e,a){},e9d7:function(t,e,a){\"use strict\";var o=a(\"ae7e\"),i=a.n(o);i.a}}]);","extractedComments":[]}