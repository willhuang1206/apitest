{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-56d01dae\"],{\"242c\":function(t,e,o){},b780:function(t,e,o){\"use strict\";var i=o(\"242c\"),a=o.n(i);a.a},fd47:function(t,e,o){\"use strict\";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o(\"section\",[o(\"el-col\",{staticClass:\"toolbar\",staticStyle:{\"padding-bottom\":\"0px\"},attrs:{span:24}},[o(\"el-form\",{attrs:{inline:!0,model:t.filters},nativeOn:{submit:function(t){t.preventDefault()}}},[o(\"el-form-item\",[o(\"el-input\",{attrs:{placeholder:\"名称\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.handleSearch(e)}},model:{value:t.filters.name,callback:function(e){t.$set(t.filters,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"filters.name\"}})],1),t._v(\" \"),o(\"el-form-item\",[o(\"el-select\",{attrs:{placeholder:\"类型\"},model:{value:t.filters.type,callback:function(e){t.$set(t.filters,\"type\",e)},expression:\"filters.type\"}},t._l(t.automationType,(function(t,e){return o(\"el-option\",{attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),o(\"el-form-item\",[o(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"},on:{click:t.handleSearch}},[t._v(\"查询\")])],1),t._v(\" \"),o(\"el-form-item\",[o(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"},on:{click:t.handleAdd}},[t._v(\"新增\")])],1),t._v(\" \"),o(\"el-form-item\",[o(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"},on:{click:t.handleImportAutomation}},[t._v(\"导入\")])],1),t._v(\" \"),o(\"el-form-item\",[o(\"el-button\",{attrs:{size:\"medium\",type:\"primary\",disabled:t.update},on:{click:t.changeGroup}},[t._v(\"修改分组\")])],1)],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{width:\"40%\",title:t.editFormTitle,visible:t.editFormVisible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.editFormVisible=e}}},[o(\"el-form\",{ref:\"editForm\",attrs:{model:t.editForm,rules:t.editFormRules,\"label-width\":\"80px\"}},[o(\"el-form-item\",{attrs:{label:\"名称\",prop:\"name\"}},[o(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"editForm.name\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"类型\",\"label-width\":\"83px\",prop:\"type\"}},[o(\"el-select\",{attrs:{placeholder:\"类型\"},model:{value:t.editForm.type,callback:function(e){t.$set(t.editForm,\"type\",e)},expression:\"editForm.type\"}},t._l(t.automationType,(function(t,e){return o(\"el-option\",{key:e+\"\",attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"分组\",\"label-width\":\"83px\",prop:\"group\"}},[o(\"treeselect\",{attrs:{options:t.group,placeholder:\"请选择\"},model:{value:t.editForm.group,callback:function(e){t.$set(t.editForm,\"group\",e)},expression:\"editForm.group\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"参数\",prop:\"params\"}},[o(\"el-input\",{attrs:{type:\"textarea\",rows:4},model:{value:t.editForm.params,callback:function(e){t.$set(t.editForm,\"params\",e)},expression:\"editForm.params\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"描述\",prop:\"description\"}},[o(\"el-input\",{attrs:{type:\"textarea\",rows:4},model:{value:t.editForm.description,callback:function(e){t.$set(t.editForm,\"description\",e)},expression:\"editForm.description\"}})],1)],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{width:\"40%\",title:\"修改所属分组\",visible:t.updateGroupFormVisible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.updateGroupFormVisible=e}}},[o(\"el-form\",{ref:\"updateGroupForm\",attrs:{model:t.updateGroupForm,\"label-width\":\"80px\",rules:t.updateGroupFormRules}},[o(\"el-form-item\",{attrs:{label:\"分组\",prop:\"firstGroup\"}},[o(\"treeselect\",{attrs:{options:t.group,placeholder:\"请选择\"},model:{value:t.updateGroupForm.firstGroup,callback:function(e){t.$set(t.updateGroupForm,\"firstGroup\",e)},expression:\"updateGroupForm.firstGroup\"}})],1)],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.updateGroupFormVisible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\",loading:t.updateGroupLoading},nativeOn:{click:function(e){return t.updateGroupSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-dialog\",{attrs:{width:\"40%\",title:\"导入用例\",visible:t.importAutomation.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.importAutomation,\"visible\",e)}}},[o(\"el-form\",{attrs:{\"label-width\":\"80px\",rules:t.importAutomation.rules}},[o(\"el-form-item\",{attrs:{label:\"文件名:\",prop:\"importAutomation.fileName\"}},[o(\"el-input\",{model:{value:t.importAutomation.fileName,callback:function(e){t.$set(t.importAutomation,\"fileName\",\"string\"===typeof e?e.trim():e)},expression:\"importAutomation.fileName\"}})],1),t._v(\" \"),o(\"el-form-item\",{attrs:{label:\"导入分组:\",prop:\"importAutomation.toGroup\"}},[o(\"treeselect\",{attrs:{options:t.group,placeholder:\"请选择\"},model:{value:t.importAutomation.toGroup,callback:function(e){t.$set(t.importAutomation,\"toGroup\",e)},expression:\"importAutomation.toGroup\"}})],1),t._v(\" \"),o(\"el-row\",[o(\"a\",{attrs:{href:t.downloadTemplateUrl}},[t._v(\"下载模板\")]),t._v(\" \"),o(\"el-upload\",{staticClass:\"upload-demo\",attrs:{action:t.uploadFileUrl,\"on-success\":t.handleUploadSuccess,limit:1,accept:\".xls,.xlsx\",\"file-list\":t.fileList}},[o(\"el-button\",{attrs:{size:\"small\",type:\"primary\"}},[t._v(\"点击上传\")]),t._v(\" \"),o(\"div\",{staticClass:\"el-upload__tip\",attrs:{slot:\"tip\"},slot:\"tip\"},[t._v(\"只能上传并导入excel文件\")])],1)],1)],1),t._v(\" \"),o(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"el-button\",{nativeOn:{click:function(e){t.importAutomation.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),o(\"el-button\",{attrs:{type:\"primary\",loading:t.importAutomation.loading},nativeOn:{click:function(e){return t.importAutomationSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),o(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.automationlist,stripe:\"\",border:\"\",\"element-loading-text\":\"拼命加载中\",\"element-loading-spinner\":\"el-icon-loading\",\"highlight-current-row\":\"\"},on:{\"selection-change\":t.selsChange}},[o(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"4%\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"id\",label:\"ID\",sortable:\"\",\"min-width\":\"8%\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",sortable:\"\",\"min-width\":\"14%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-icon\",{attrs:{name:\"name\"}}),t._v(\" \"),o(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"自动化步骤列表\",params:{automation_id:e.row.id}}}},[t._v(t._s(e.row.name))])]}}])}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"type\",label:\"类型\",\"min-width\":\"6%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"userUpdate\",label:\"更新人\",\"min-width\":\"8%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{prop:\"updateTime\",label:\"更新日期\",\"min-width\":\"15%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),o(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"15%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[o(\"el-dropdown\",[o(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"更新自动化步骤\",params:{automation_id:e.row.id,type:\"update\"}}}},[o(\"el-button\",{attrs:{type:\"primary\",size:\"small\",plain:\"\"}},[t._v(\"修改\"),o(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})])],1),t._v(\" \"),o(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[o(\"el-dropdown-item\",[o(\"el-button\",{attrs:{type:\"primary\",size:\"small\",plain:\"\"},on:{click:function(o){return t.handleCopy(e.$index,e.row)}}},[t._v(\"复制\")])],1),t._v(\" \"),o(\"el-dropdown-item\",[o(\"el-button\",{attrs:{type:\"danger\",size:\"small\",plain:\"\"},on:{click:function(o){return t.handleDel(e.$index,e.row)}}},[t._v(\"删除\")])],1)],1)],1)]}}])})],1),t._v(\" \"),o(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[o(\"el-button\",{attrs:{type:\"danger\",disabled:0===this.sels.length},on:{click:t.batchRemove}},[t._v(\"批量删除\")]),t._v(\" \"),o(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":t.page,total:t.total,\"page-size\":t.page_size,\"page-count\":t.pages},on:{\"current-change\":t.handleCurrentChange,\"update:currentPage\":function(e){t.page=e},\"update:current-page\":function(e){t.page=e}}})],1)],1)},a=[],r=(o(\"c5f6\"),o(\"ac6a\"),o(\"7f7f\"),o(\"ca17\")),n=o.n(r),s=o(\"a78e\"),l=o.n(s),u=(o(\"542c\"),o(\"4ec3\")),p=(o(\"1157\"),o(\"c1df\"),o(\"bc3a\")),m=o.n(p),d={components:{Treeselect:n.a},data:function(){return{automationType:[{value:\"\",label:\"\"},{value:\"case\",label:\"普通用例\"},{value:\"reuse\",label:\"可复用用例\"},{value:\"list\",label:\"用例集\"},{value:\"data\",label:\"数据用例\"},{value:\"monitor\",label:\"接口监控\"}],listType:\"\",filters:{name:\"\",type:\"\"},env:\"\",automationlist:[],total:0,pages:0,page:1,page_size:20,listLoading:!1,sels:[],delLoading:!1,disDel:!0,TestStatus:!1,updateGroupFormVisible:!1,updateGroupForm:{firstGroup:null},updateGroupFormRules:{firstGroup:[{type:\"number\",required:!0,message:\"请选择父分组\",trigger:\"blur\"}]},group:[],updateGroupLoading:!1,update:!0,editFormVisible:!1,editFormTitle:\"\",editLoading:!1,editFormRules:{name:[{required:!0,message:\"请输入名称\",trigger:\"blur\"},{min:1,max:1024,message:\"长度在 1 到 1024 个字符\",trigger:\"blur\"}],group:[{required:!0,message:\"请选择分组\",trigger:\"blur\"}],description:[{required:!1,message:\"请输入描述\",trigger:\"blur\"},{max:1024,message:\"不能超过1024个字符\",trigger:\"blur\"}]},editForm:{name:\"\",group:null,description:\"\",params:\"{}\",type:\"case\"},getResultTimer:\"\",importAutomation:{visible:!1,loading:!1,rules:{fromGroup:[{type:\"string\",required:!0,message:\"请选择源分组\",trigger:\"blur\"}],toGroup:[{type:\"string\",required:!0,message:\"请选择导入分组\",trigger:\"blur\"}]},value:null,fromGroup:null,toGroup:null,fromDate:\"\",toDate:\"\",groups:[],fileName:\"\"},fileList:[],formData:[],role:l.a.get(\"role\"),uploadFileUrl:u[\"f\"]+\"/api/imports/uploadfile\",downloadTemplateUrl:u[\"f\"]+\"/api/imports/downloadtemplate\"}},methods:{handleUploadSuccess:function(t,e){this.importAutomation.fileName=e.name},handleSearch:function(){this.page=1,this.getAutomationList()},getAutomationList:function(){this.listLoading=!0;var t=this;sessionStorage.setItem(\"auto_name\",t.filters.name),sessionStorage.setItem(\"auto_type\",t.filters.type);var e={project_id:this.$route.params.project_id,page:t.page,name:t.filters.name,type:t.filters.type};this.$route.params.firstGroup&&(e[\"first_group_id\"]=this.$route.params.firstGroup),m.a.get(u[\"f\"]+\"/api/automation/automation_list\",{params:e}).then((function(e){t.listLoading=!1,\"999999\"===e.data.code?(t.total=e.data.data.total,t.pages=e.data.data.pages,t.page_size=e.data.data.page_size,t.automationlist=[],e.data.data.data.forEach((function(e){e.result=!1,t.automationlist.push(e)}))):t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},getAutomationDomainList:function(){this.importAutomation.loading=!0;var t=this,e={};m.a.get(u[\"f\"]+\"/api/imports/autodomainlist\",{params:e,headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var o=e.data;t.importAutomation.loading=!1,\"999999\"===o.code?t.importAutomation.groups=o.data:t.$message.error({message:o.msg,center:!0})})).catch((function(t){}))},updateGroupSubmit:function(){var t=this,e=this.sels.map((function(t){return t.id})),o=this;this.$confirm(\"确认修改所属分组吗？\",\"提示\",{type:\"warning\"}).then((function(){o.updateGroupLoading=!0;var i=JSON.stringify({project_id:Number(t.$route.params.project_id),group_id:o.updateGroupForm.firstGroup,ids:e}),a={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(u[\"f\"]+\"/api/automation/update_automation_group\",i,{headers:a}).then((function(t){o.updateGroupLoading=!1,\"999999\"===t.data.code?(o.$message({message:\"修改成功\",center:!0,type:\"success\"}),o.$router.push({name:\"分组自动化列表\",params:{project_id:o.$route.params.project_id,firstGroup:o.updateGroupForm.firstGroup}})):o.$message.error({message:t.data.msg,center:!0}),o.updateGroupFormVisible=!1,o.getAutomationList()})).catch((function(t){}))})).catch((function(){}))},importAutomationSubmit:function(){var t=this,e=this;this.$confirm(\"确认导入用例吗？\",\"提示\",{type:\"warning\"}).then((function(){t.importAutomation.loading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),group_id:t.importAutomation.toGroup,fileName:t.importAutomation.fileName});m.a.post(u[\"f\"]+\"/api/imports/automation_importfromexcel\",o,{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var o=t.data;e.importAutomation.loading=!1,\"999999\"===o.code?e.$message({message:o.msg,center:!0,type:\"success\"}):e.$message.error({message:o.msg,center:!0}),e.importAutomation.visible=!1,e.getAutomationList()})).catch((function(t){}))})).catch((function(){}))},getAutomationGroup:function(){var t=this;m.a.get(u[\"f\"]+\"/api/automation/group\",{params:{project_id:this.$route.params.project_id}}).then((function(e){\"999999\"===e.data.code?t.group=e.data.data:t.$message.error({message:e.data.msg,center:!0})})).catch((function(t){}))},changeGroup:function(){this.getAutomationGroup(),this.updateGroupFormVisible=!0},handleImportAutomation:function(){this.getAutomationGroup(),this.importAutomation.visible=!0},handleDel:function(t,e){var o=this;this.$confirm(\"确认删除用例[\"+e.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){o.listLoading=!0;var t=o,i=JSON.stringify({project_id:Number(o.$route.params.project_id),ids:[e.id]}),a={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(u[\"f\"]+\"/api/automation/del_automation\",i,{headers:a}).then((function(e){\"999999\"===e.data.code?t.$message({message:\"删除成功\",center:!0,type:\"success\"}):t.$message.error({message:e.data.msg,center:!0}),o.listLoading=!0,t.getAutomationList()})).catch((function(t){o.listLoading=!0}))})).catch((function(){}))},handleCurrentChange:function(t){this.page=t,this.getAutomationList()},selsChange:function(t){t.length>0?(this.sels=t,this.update=!1):this.update=!0},batchRemove:function(){var t=this,e=this.sels.map((function(t){return t.id})),o=this;this.$confirm(\"确认删除选中记录吗？\",\"提示\",{type:\"warning\"}).then((function(){o.listLoading=!0;var i=JSON.stringify({project_id:Number(t.$route.params.project_id),ids:e}),a={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(u[\"f\"]+\"/api/automation/del_automation\",i,{headers:a}).then((function(t){o.listLoading=!1,\"999999\"===t.data.code?o.$message({message:\"删除成功\",center:!0,type:\"success\"}):o.$message.error({message:t.data.msg,center:!0}),o.getAutomationList()})).catch((function(t){}))})).catch((function(){}))},handleEdit:function(t,e){this.getAutomationGroup(),this.editFormTitle=\"编辑\",this.editFormVisible=!0,this.editForm={id:e.id,name:e.name,type:e.type,params:e.params,group:e.group,description:e.description}},handleCopy:function(t,e){this.getAutomationGroup(),this.editFormTitle=\"复制\",this.editForm={copyId:e.id,name:e.name,type:e.type,params:e.params,group:e.group,description:e.description},this.editFormVisible=!0},handleAdd:function(){this.getAutomationGroup(),this.editFormTitle=\"新增\",this.editFormVisible=!0},editSubmit:function(){var t=this;if(null==this.editForm.id)this.addSubmit();else{var e=this;this.$refs.editForm.validate((function(o){o&&t.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){e.editLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),id:Number(e.editForm.id),type:e.editForm.type,name:e.editForm.name,params:e.editForm.params,group_id:Number(t.editForm.group),description:e.editForm.description}),i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(u[\"f\"]+\"/api/automation/update_automation\",o,{headers:i}).then((function(t){e.editLoading=!1,\"999999\"===t.data.code?(e.$message({message:\"修改成功\",center:!0,type:\"success\"}),e.$refs[\"editForm\"].resetFields(),e.editFormVisible=!1,e.getAutomationList()):(t.data.code,e.$message.error({message:t.data.msg,center:!0}))})).catch((function(t){}))})).catch((function(){}))}))}},addSubmit:function(){var t=this;this.$refs.editForm.validate((function(e){if(e){var o=t;t.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){o.editLoading=!0;var e={project_id:Number(t.$route.params.project_id),type:t.editForm.type,group_id:Number(t.editForm.group),name:o.editForm.name,params:o.editForm.params,description:o.editForm.description};\"复制\"==t.editFormTitle&&(e[\"copyId\"]=o.editForm.copyId),e=JSON.stringify(e);var i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};m.a.post(u[\"f\"]+\"/api/automation/add_automation\",e,{headers:i}).then((function(t){o.editLoading=!1,\"999999\"===t.data.code?(o.$message({message:\"添加成功\",center:!0,type:\"success\"}),o.$refs[\"editForm\"].resetFields(),o.editFormVisible=!1,o.getAutomationList()):\"999997\"===t.data.code?o.$message.error({message:t.data.msg,center:!0}):(o.$message.error({message:t.data.msg,center:!0}),o.$refs[\"editForm\"].resetFields(),o.editFormVisible=!1,o.getAutomationList())})).catch((function(t){}))})).catch((function(){}))}}))},init:function(){null!=sessionStorage.getItem(\"auto_name\")&&(this.filters.name=sessionStorage.getItem(\"auto_name\")),null!=sessionStorage.getItem(\"auto_type\")&&(this.filters.type=sessionStorage.getItem(\"auto_type\")),this.getAutomationList(),this.$route.params.firstGroup&&(this.updateGroupForm.firstGroup=Number(this.$route.params.firstGroup),this.editForm.group=Number(this.$route.params.firstGroup))}},mounted:function(){this.init()},watch:{$route:function(t,e){t.query!=e.query&&this.init()}}},c=d,g=(o(\"b780\"),o(\"2877\")),f=Object(g[\"a\"])(c,i,a,!1,null,\"306b018d\",null);e[\"default\"]=f.exports}}]);","extractedComments":[]}