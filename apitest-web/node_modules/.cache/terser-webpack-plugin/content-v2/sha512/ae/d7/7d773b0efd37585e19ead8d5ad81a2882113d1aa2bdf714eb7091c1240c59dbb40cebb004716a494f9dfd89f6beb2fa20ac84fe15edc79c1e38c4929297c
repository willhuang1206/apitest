{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-0009ac5b\"],{\"1f02\":function(e,t,a){\"use strict\";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"app-container\"},[i(\"div\",{staticClass:\"filter-container\"},[i(\"el-input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"名称\"},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.handleSearch(t)}},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,\"name\",\"string\"===typeof t?t.trim():t)},expression:\"filters.name\"}}),e._v(\" \"),i(\"el-select\",{staticStyle:{width:\"200px\"},attrs:{clearable:\"\",placeholder:\"类型\"},model:{value:e.filters.type,callback:function(t){e.$set(e.filters,\"type\",t)},expression:\"filters.type\"}},e._l(e.type,(function(e,t){return i(\"el-option\",{attrs:{label:e.label,value:e.value}})})),1),e._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleSearch}},[e._v(\"查询\")]),e._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-edit\"},on:{click:e.handleAdd}},[e._v(\"新增\")])],1),e._v(\" \"),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.globalConfig,stripe:\"\",border:\"\",\"highlight-current-row\":\"\"},on:{\"selection-change\":e.selsChange}},[i(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"5%\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"type\",label:\"类型\",\"min-width\":\"10%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"value\",label:\"值\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"description\",label:\"描述\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"status\",label:\"状态\",\"min-width\":\"5%\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[i(\"img\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.row.status,expression:\"scope.row.status\"}],attrs:{src:a(\"4928\")}}),e._v(\" \"),i(\"img\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.row.status,expression:\"!scope.row.status\"}],attrs:{src:a(\"60be\")}})]}}])}),e._v(\" \"),i(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"20%\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[i(\"el-dropdown\",[i(\"el-button\",{attrs:{size:\"small\",type:\"primary\",plain:\"\"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v(\"编辑\"),i(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),e._v(\" \"),i(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[i(\"el-dropdown-item\",[i(\"el-button\",{attrs:{type:\"danger\",size:\"small\",plain:\"\"},on:{click:function(a){return e.handleDel(t.$index,t.row)}}},[e._v(\"删除\")])],1),e._v(\" \"),i(\"el-dropdown-item\",[i(\"el-button\",{attrs:{type:\"info\",size:\"small\",plain:\"\"},on:{click:function(a){return e.handleChangeStatus(t.$index,t.row)}}},[e._v(e._s(!1===t.row.status?\"启用\":\"禁用\"))])],1)],1)],1)]}}])})],1),e._v(\" \"),i(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[i(\"el-button\",{attrs:{type:\"danger\",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v(\"批量删除\")]),e._v(\" \"),i(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":e.page,total:e.total,\"page-size\":20,\"page-count\":e.pages},on:{\"current-change\":e.handleCurrentChange,\"update:currentPage\":function(t){e.page=t},\"update:current-page\":function(t){e.page=t}}})],1),e._v(\" \"),i(\"el-dialog\",{attrs:{width:\"40%\",title:e.editForm.title,visible:e.editForm.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){return e.$set(e.editForm,\"visible\",t)}}},[i(\"el-form\",{ref:\"editForm\",attrs:{model:e.editForm.data,rules:e.editForm.rules,\"label-width\":\"80px\"}},[i(\"el-form-item\",{attrs:{label:\"名称\",prop:\"name\"}},[i(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:e.editForm.data.name,callback:function(t){e.$set(e.editForm.data,\"name\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.data.name\"}})],1),e._v(\" \"),i(\"el-form-item\",{attrs:{label:\"类型\",prop:\"type\"}},[i(\"el-select\",{attrs:{placeholder:\"类型\"},model:{value:e.editForm.data.type,callback:function(t){e.$set(e.editForm.data,\"type\",t)},expression:\"editForm.data.type\"}},e._l(e.type,(function(e,t){return i(\"el-option\",{attrs:{label:e.label,value:e.value}})})),1)],1),e._v(\" \"),i(\"el-form-item\",{attrs:{label:\"值\",prop:\"value\"}},[i(\"el-input\",{attrs:{type:\"textarea\",rows:5},model:{value:e.editForm.data.value,callback:function(t){e.$set(e.editForm.data,\"value\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.data.value\"}})],1),e._v(\" \"),i(\"el-form-item\",{attrs:{label:\"描述\",prop:\"description\"}},[i(\"el-input\",{attrs:{type:\"textarea\",rows:5},model:{value:e.editForm.data.description,callback:function(t){e.$set(e.editForm.data,\"description\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.data.description\"}})],1)],1),e._v(\" \"),i(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[i(\"el-button\",{nativeOn:{click:function(t){e.editForm.visible=!1}}},[e._v(\"取消\")]),e._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",loading:e.editForm.loading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v(\"提交\")])],1)],1)],1)},o=[],n=(a(\"c5f6\"),a(\"7f7f\"),a(\"4ec3\")),s=a(\"bc3a\"),r=a.n(s),l={data:function(){return{globalConfig:[],type:[{value:\"config\",label:\"配置\"},{value:\"tag\",label:\"标签\"}],filters:{name:\"\"},total:0,page:1,pages:0,listLoading:!1,sels:[],editForm:{data:{id:\"\",name:\"\",type:\"config\",value:\"\",description:\"\"},visible:!1,loading:!1,rules:{name:[{required:!0,message:\"请输入名称\",trigger:\"blur\"},{min:1,max:50,message:\"长度在 1 到 50 个字符\",trigger:\"blur\"}],type:[{required:!0,message:\"请选择类型\",trigger:\"blur\"}],value:[{required:!0,message:\"请输入值\",trigger:\"blur\"}],description:[{required:!1,message:\"请输入描述\",trigger:\"blur\"},{max:1024,message:\"不能超过1024个字符\",trigger:\"blur\"}]}}}},methods:{getGlobalConfig:function(){this.listLoading=!0;var e=this,t={page:e.page,name:e.filters.name,type:e.filters.type},a={Authorization:\"Token \"+sessionStorage.getItem(\"token\")};r.a.get(\"\".concat(n[\"f\"],\"/api/global/config_list\"),{params:t,headers:a}).then((function(t){var a=t.data,i=a.msg,o=a.code,n=a.data;e.listLoading=!1,\"999999\"===o?(e.total=n.total,e.globalConfig=n.data,e.pages=n.pages):e.$message.error({message:i,center:!0})}))},handleSearch:function(){this.page=1,this.getGlobalConfig()},handleDel:function(e,t){var a=this;this.$confirm(\"确认删除配置[\"+t.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var e=a,i={ids:[t.id]},o={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};r.a.post(\"\".concat(n[\"f\"],\"/api/global/del_config\"),i,{headers:o}).then((function(t){var a=t.data,i=a.msg,o=a.code;a.data;\"999999\"===o?e.$message({message:\"删除成功\",center:!0,type:\"success\"}):e.$message.error({message:i,center:!0}),e.getGlobalConfig()}))})).catch((function(){}))},handleChangeStatus:function(e,t){var a=this;this.listLoading=!0;var i={config_id:Number(t.id)},o={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};t.status?r.a.post(\"\".concat(n[\"f\"],\"/api/global/disable_config\"),i,{headers:o}).then((function(e){var i=e.data,o=i.msg,n=i.code;i.data;a.listLoading=!1,\"999999\"===n?(a.$message({message:\"禁用成功\",center:!0,type:\"success\"}),t.status=!t.status):a.$message.error({message:o,center:!0})})):r.a.post(\"\".concat(n[\"f\"],\"/api/global/enable_config\"),i,{headers:o}).then((function(e){var i=e.data,o=i.msg,n=i.code;i.data;a.listLoading=!1,\"999999\"===n?(a.$message({message:\"启用成功\",center:!0,type:\"success\"}),t.status=!t.status):a.$message.error({message:o,center:!0})}))},handleCurrentChange:function(e){this.page=e,this.getGlobalConfig()},handleEdit:function(e,t){this.editForm.title=\"编辑\",this.editForm.visible=!0,this.editForm.data=Object.assign({},t)},handleAdd:function(){this.editForm.title=\"新增\",this.editForm.visible=!0,this.editForm.data={id:\"\",name:\"\",type:\"config\",value:\"\",description:\"\"}},editSubmit:function(){var e=this,t=this;this.$refs.editForm.validate((function(a){a&&e.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){t.editForm.loading=!0;var e={name:t.editForm.data.name,type:t.editForm.data.type,value:t.editForm.data.value,description:t.editForm.data.description},a=\"\".concat(n[\"f\"],\"/api/global/add_config\");\"\"!=t.editForm.data.id&&(e[\"id\"]=Number(t.editForm.data.id),a=\"\".concat(n[\"f\"],\"/api/global/update_config\"));var i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};r.a.post(a,e,{headers:i}).then((function(e){var a=e.data,i=a.msg,o=a.code;a.data;t.editForm.loading=!1,\"999999\"===o?(t.$message({message:\"执行成功\",center:!0,type:\"success\"}),t.$refs[\"editForm\"].resetFields(),t.editForm.visible=!1,t.getGlobalConfig()):t.$message.error({message:i,center:!0})}))})).catch((function(){}))}))},selsChange:function(e){this.sels=e},batchRemove:function(){var e=this.sels.map((function(e){return e.id})),t=this;this.$confirm(\"确认删除选中记录吗？\",\"提示\",{type:\"warning\"}).then((function(){t.listLoading=!0;var a={ids:e},i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};r.a.post(\"\".concat(n[\"f\"],\"/api/global/del_config\"),a,{headers:i}).then((function(e){var a=e.data,i=a.msg,o=a.code;a.data;t.listLoading=!1,\"999999\"===o?t.$message({message:\"删除成功\",center:!0,type:\"success\"}):t.$message.error({message:i,center:!0}),t.getGlobalConfig()}))})).catch((function(){}))}},mounted:function(){this.getGlobalConfig()}},c=l,d=a(\"2877\"),p=Object(d[\"a\"])(c,i,o,!1,null,null,null);t[\"default\"]=p.exports},4928:function(e,t,a){e.exports=a.p+\"static/img/icon-yes.d2f9f035.svg\"},\"60be\":function(e,t,a){e.exports=a.p+\"static/img/icon-no.439e8214.svg\"}}]);","extractedComments":[]}