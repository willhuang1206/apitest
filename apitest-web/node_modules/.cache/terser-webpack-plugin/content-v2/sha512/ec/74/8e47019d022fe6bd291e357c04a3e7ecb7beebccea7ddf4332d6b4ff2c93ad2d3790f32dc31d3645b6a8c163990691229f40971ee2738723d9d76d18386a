{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d2073e1\"],{a062:function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"app-container\"},[a(\"div\",{staticClass:\"filter-container\"},[a(\"el-input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"名称\"},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.handleSearch(t)}},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,\"name\",\"string\"===typeof t?t.trim():t)},expression:\"filters.name\"}}),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleSearch}},[e._v(\"查询\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-edit\"},on:{click:e.handleAdd}},[e._v(\"新增\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handleLink}},[e._v(\"关联\")])],1),e._v(\" \"),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.userlist,stripe:\"\",border:\"\",\"highlight-current-row\":\"\"},on:{\"selection-change\":e.selsChange}},[a(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"5%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"username\",label:\"用户名\",\"min-width\":\"15%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"姓名\",\"min-width\":\"10%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),e._e(),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"email\",label:\"邮箱\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"phone\",label:\"手机号\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"type\",label:\"类型\",\"min-width\":\"10%\",\"show-overflow-tooltip\":\"\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"20%\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"local\"===t.row.type,expression:\"scope.row.type==='local'\"}],attrs:{type:\"primary\",size:\"small\",plain:\"\"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v(\"编辑\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"danger\",size:\"small\",plain:\"\"},on:{click:function(a){return e.handleDel(t.$index,t.row)}}},[e._v(\"删除\")])]}}])})],1),e._v(\" \"),a(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[a(\"el-button\",{attrs:{type:\"danger\",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v(\"批量删除\")]),e._v(\" \"),a(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":e.page,total:e.total,\"page-size\":20,\"page-count\":e.pages},on:{\"current-change\":e.handleCurrentChange,\"update:currentPage\":function(t){e.page=t},\"update:current-page\":function(t){e.page=t}}})],1),e._v(\" \"),a(\"el-dialog\",{attrs:{width:\"40%\",title:e.editForm.title,visible:e.editForm.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){return e.$set(e.editForm,\"visible\",t)}}},[a(\"el-form\",{ref:\"editForm\",attrs:{model:e.editForm,rules:e.editForm.rules,\"label-width\":\"80px\"}},[a(\"el-form-item\",{attrs:{label:\"用户名\",prop:\"username\"}},[a(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,\"username\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.username\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"姓名\",prop:\"name\"}},[a(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,\"name\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.name\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"密码\",prop:\"password\"}},[a(\"el-input\",{attrs:{type:\"password\",\"auto-complete\":\"off\",placeholder:\"密码\"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,\"password\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.password\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"验证密码\",prop:\"checkPass\"}},[a(\"el-input\",{attrs:{type:\"password\",\"auto-complete\":\"off\",placeholder:\"密码\"},model:{value:e.editForm.checkPass,callback:function(t){e.$set(e.editForm,\"checkPass\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.checkPass\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"邮箱\",prop:\"email\"}},[a(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,\"email\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.email\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"手机号\",prop:\"phone\"}},[a(\"el-input\",{attrs:{\"auto-complete\":\"off\"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,\"phone\",\"string\"===typeof t?t.trim():t)},expression:\"editForm.phone\"}})],1)],1),e._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{nativeOn:{click:function(t){e.editForm.visible=!1}}},[e._v(\"取消\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\",loading:e.editForm.loading},nativeOn:{click:function(t){return e.editFormSubmit(t)}}},[e._v(\"提交\")])],1)],1),e._v(\" \"),a(\"el-dialog\",{attrs:{width:\"50%\",title:\"关联用户\",visible:e.users.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){return e.$set(e.users,\"visible\",t)}}},[a(\"el-row\",{attrs:{gutter:10}},[a(\"el-col\",{attrs:{span:24}},[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.users.loading,expression:\"users.loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.users.list,\"highlight-current-row\":\"\",\"show-header\":!0,\"max-height\":\"400\"},on:{\"selection-change\":e.selUsersChange}},[a(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"5%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"user_id\",label:\"ID\",\"min-width\":\"10%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"user_name\",label:\"用户名\",\"min-width\":\"20%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"姓名\",\"min-width\":\"20%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"phone\",label:\"手机\",\"min-width\":\"20%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"email\",label:\"邮箱\",\"min-width\":\"25%\"}})],1)],1)],1),e._v(\" \"),a(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[a(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":e.users.page,total:e.users.total,\"page-size\":20,\"page-count\":e.users.pages},on:{\"current-change\":e.handleCurrentChangeUser,\"update:currentPage\":function(t){return e.$set(e.users,\"page\",t)},\"update:current-page\":function(t){return e.$set(e.users,\"page\",t)}}})],1),e._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{nativeOn:{click:function(t){e.users.visible=!1}}},[e._v(\"取消\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\",loading:e.users.loading},nativeOn:{click:function(t){return e.linkUsersSubmit(t)}}},[e._v(\"提交\")])],1)],1)],1)},i=[],r=(a(\"c5f6\"),a(\"ac6a\"),a(\"7f7f\"),a(\"bd86\")),o=a(\"4ec3\"),n=a(\"bc3a\"),l=a.n(n),c=a(\"8237\"),d=a.n(c),m={data:function(){return Object(r[\"a\"])({filters:{name:\"\"},total:0,page:1,pages:0,users:[],userlist:[],listLoading:!1,sels:[],editForm:{id:\"\",visible:!1,loading:!1,title:\"新增\",username:\"\",name:\"\",password:\"\",checkPass:\"\",email:\"\",phone:\"\",rules:{username:[{required:!0,message:\"请输入用户名\",trigger:\"blur\"},{min:4,max:10,message:\"长度在 4 到 10 个字符\",trigger:\"blur\"}],name:[{required:!0,message:\"请输入姓名\",trigger:\"blur\"},{min:2,max:4,message:\"长度在 2 到 4 个字符\",trigger:\"blur\"}],password:[{required:!0,message:\"请输入密码\",trigger:\"blur\"},{min:6,max:50,message:\"长度至少为6\",trigger:\"blur\"}],checkPass:[{required:!0,message:\"请再次输入密码\",trigger:\"blur\"},{min:6,max:50,message:\"长度至少为6\",trigger:\"blur\"}],email:[{required:!0,message:\"请输入邮箱\",trigger:\"blur\"}]}}},\"users\",{visible:!1,loading:!1,list:[],total:0,page:1,pages:0,selUsers:[]})},methods:{handleSearch:function(){this.page=1,this.getGlobalUser()},getGlobalUser:function(){this.listLoading=!0;var e=this,t={page:e.page,name:e.filters.name};sessionStorage.getItem(\"token\");l.a.get(o[\"f\"]+\"/api/global/user_list\",{params:t}).then((function(t){e.listLoading=!1,\"999999\"===t.data.code?(e.total=t.data.data.total,e.pages=t.data.data.pages,e.userlist=[],t.data.data.data.forEach((function(t){e.userlist.push(t)}))):e.$message.error({message:t.data.msg,center:!0})})).catch((function(e){}))},getUsers:function(){var e=this;e.users.loading=!0;var t={page:e.users.page};l.a.get(o[\"f\"]+\"/api/global/get_users\",{params:t}).then((function(t){e.users.loading=!1,\"999999\"===t.data.code?(e.users.list=t.data.data.data,e.users.total=t.data.data.total,e.users.pages=t.data.data.pages):e.$message.error({message:t.data.msg,center:!0})})).catch((function(e){}))},handleDel:function(e,t){var a=this;this.$confirm(\"确认删除用户[\"+t.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){a.listLoading=!0;var e=a,s={ids:[t.id]},i={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};l.a.post(o[\"f\"]+\"/api/global/del_user\",s,{headers:i}).then((function(t){var a=t.data;\"999999\"===a.code?e.$message({message:\"删除成功\",center:!0,type:\"success\"}):e.$message.error({message:a.msg,center:!0}),e.getGlobalUser()})).catch((function(e){}))})).catch((function(){}))},handleCurrentChange:function(e){this.page=e,this.getGlobalUser()},handleCurrentChangeUser:function(e){this.users.page=e,this.getUsers()},handleEdit:function(e,t){this.editForm.visible=!0,this.editForm.title=\"编辑\";try{this.editForm.id=t.id,this.editForm.username=t.username,this.editForm.name=t.name,this.editForm.password=t.password,this.editForm.checkPass=t.password,this.editForm.email=t.email,this.editForm.phone=t.phone}catch(a){alert(a)}},handleAdd:function(){this.editForm.id=\"\",this.editForm.username=\"\",this.editForm.name=\"\",this.editForm.password=\"\",this.editForm.checkPass=\"\",this.editForm.email=\"\",this.editForm.phone=\"\",this.editForm.visible=!0,this.editForm.title=\"新增\"},handleLink:function(){this.users.visible=!0,this.users.page=1,this.getUsers()},linkUsersSubmit:function(){var e=this.users.selUsers.map((function(e){return e.user_id})),t=this;this.$confirm(\"确认关联选中的用户吗？\",\"提示\",{type:\"warning\"}).then((function(){t.listLoading=!0;var a=JSON.stringify({ids:e}),s={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};l.a.post(o[\"f\"]+\"/api/global/link_users\",a,{headers:s}).then((function(e){t.listLoading=!1,\"999999\"===e.data.code?t.$message({message:\"关联成功\",center:!0,type:\"success\"}):t.$message.error({message:e.data.msg,center:!0}),t.users.visible=!1,t.getGlobalUser()})).catch((function(e){}))})).catch((function(){}))},editFormSubmit:function(){var e=this;if(this.editForm.password==this.editForm.checkPass){var t=this;this.$refs.editForm.validate((function(a){a&&e.$confirm(\"确认提交吗？\",\"提示\",{}).then((function(){t.editForm.loading=!0;var e={id:Number(t.editForm.id),username:t.editForm.username,name:t.editForm.name,password:d()(t.editForm.password),email:t.editForm.email,phone:t.editForm.phone},a={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")},s=o[\"f\"]+\"/api/global/add_user\";\"\"!=t.editForm.id&&(s=o[\"f\"]+\"/api/global/update_user\"),l.a.post(s,e,{headers:a}).then((function(e){t.editForm.loading=!1,\"999999\"===e.data.code?(t.$message({message:\"成功\",center:!0,type:\"success\"}),t.editForm.visible=!1,t.getGlobalUser()):t.$message.error({message:e.data.msg,center:!0})})).catch((function(e){}))})).catch((function(){}))}))}else this.$message.error({message:\"两次输入的密码不一致,请重新输入!\",center:!0})},selsChange:function(e){this.sels=e},selUsersChange:function(e){this.users.selUsers=e},batchRemove:function(){var e=this.sels.map((function(e){return e.id})),t=this;this.$confirm(\"确认删除选中的用户吗？\",\"提示\",{type:\"warning\"}).then((function(){t.listLoading=!0;var a={ids:e},s={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};l.a.post(o[\"f\"]+\"/api/global/del_user\",a,{headers:s}).then((function(e){var a=e.data;\"999999\"===a.code?t.$message({message:\"删除成功\",center:!0,type:\"success\"}):t.$message.error({message:a.msg,center:!0}),t.getGlobalUser()})).catch((function(e){}))})).catch((function(){}))}},mounted:function(){this.getGlobalUser()}},u=m,p=a(\"2877\"),g=Object(p[\"a\"])(u,s,i,!1,null,null,null);t[\"default\"]=g.exports}}]);","extractedComments":[]}