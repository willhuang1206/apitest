{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-c3a31b64\"],{1612:function(e,t,a){},\"99af\":function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"el-row\",{staticClass:\"member-manage\"},[a(\"p\",{staticStyle:{color:\"#999\"}},[a(\"strong\",[e._v(\"项目成员\")])]),e._v(\" \"),a(\"el-dialog\",{attrs:{width:\"50%\",title:\"更新成员权限\",visible:e.users.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){return e.$set(e.users,\"visible\",t)}}},[a(\"el-select\",{attrs:{filterable:\"\",placeholder:\"请选择权限\"},model:{value:e.users.group,callback:function(t){e.$set(e.users,\"group\",t)},expression:\"users.group\"}},e._l(e.groups,(function(e,t){return a(\"el-option\",{key:t+\"\",attrs:{label:e.label,value:e.value}})})),1),e._v(\" \"),a(\"el-row\",{attrs:{gutter:10}},[a(\"el-col\",{attrs:{span:18}},[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.users.loading,expression:\"users.loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.users.list,\"highlight-current-row\":\"\",\"show-header\":!0,\"max-height\":\"400\"},on:{\"selection-change\":e.selUsersChange}},[a(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"id\",label:\"ID\",\"min-width\":\"10%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"username\",label:\"用户名\",\"min-width\":\"20%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"姓名\",\"min-width\":\"20%\"}})],1)],1)],1),e._v(\" \"),a(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[a(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":e.users.page,total:e.users.total,\"page-size\":20,\"page-count\":e.users.pages},on:{\"current-change\":e.handleCurrentChangeUser,\"update:currentPage\":function(t){return e.$set(e.users,\"page\",t)},\"update:current-page\":function(t){return e.$set(e.users,\"page\",t)}}})],1),e._v(\" \"),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{nativeOn:{click:function(t){e.users.visible=!1}}},[e._v(\"取消\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"primary\",loading:e.users.loading},nativeOn:{click:function(t){return e.updateUsersSubmit(t)}}},[e._v(\"提交\")])],1)],1),e._v(\" \"),a(\"el-col\",{attrs:{span:24}},[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.memberData,\"highlight-current-row\":\"\"}},[a(\"el-table-column\",{attrs:{prop:\"username\",label:\"姓名\",\"min-width\":\"30%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"group\",label:\"权限\",\"min-width\":\"30%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"userPhone\",label:\"手机号\",\"min-width\":\"20%\"}}),e._v(\" \"),a(\"el-table-column\",{attrs:{prop:\"userEmail\",label:\"邮箱地址\",\"min-width\":\"20%\"}})],1),e._v(\" \"),a(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":e.page,total:e.total,\"page-size\":20,\"page-count\":e.pages},on:{\"current-change\":e.handleCurrentChange,\"update:currentPage\":function(t){e.page=t},\"update:current-page\":function(t){e.page=t}}})],1),e._v(\" \"),a(\"el-col\",{staticClass:\"toolbar\",staticStyle:{\"padding-bottom\":\"0px\"},attrs:{span:24}},[a(\"el-form\",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handleUpdate}},[e._v(\"更新\")])],1)],1)],1)],1)},r=[],n=(a(\"ac6a\"),a(\"4ec3\")),i=a(\"bc3a\"),l=a.n(i),o={data:function(){return{groups:[{value:\"1\",label:\"管理员\"},{value:\"2\",label:\"测试经理\"},{value:\"3\",label:\"测试成员\"},{value:\"4\",label:\"项目成员\"},{value:\"0\",label:\"无权限\"}],memberData:[],total:0,page:1,pages:0,listLoading:!1,reportFrom:\"\",editFormVisible:!1,editLoading:!1,editFormRules:{reportFrom:[{required:!0,message:\"请输入发送人\",trigger:\"blur\"},{min:1,max:100,message:\"长度在 1 到 100 个字符\",trigger:\"blur\"}],mailUser:[{required:!0,message:\"请输入用户名\",trigger:\"blur\"},{min:1,max:100,message:\"长度在 1 到 100 个字符\",trigger:\"blur\"}],mailPass:[{required:!0,message:\"请输入口令\",trigger:\"blur\"},{min:1,max:100,message:\"长度在 1 到 100 个字符\",trigger:\"blur\"}],mailSmtp:[{required:!1,message:\"请输入邮件服务器\",trigger:\"blur\"},{min:1,max:100,message:\"长度在 1 到 100 个字符\",trigger:\"blur\"}]},editForm:{},users:{visible:!1,loading:!1,list:[],total:0,selUsers:[],page:1,pages:0}}},methods:{handleCurrentChange:function(e){this.page=e,this.getProjectMember()},getProjectMember:function(){this.listLoading=!0;var e=this,t={project_id:this.$route.params.project_id,page:e.page},a={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};l.a.get(\"\".concat(n[\"f\"],\"/api/member/project_member\"),{params:t,headers:a}).then((function(t){var a=t.data,s=a.msg,r=a.code,n=a.data;e.listLoading=!1,\"999999\"===r?(e.total=n.total,e.pages=n.pages,e.memberData=n.data):e.$message.error({message:s,center:!0})}))},handleCurrentChangeUser:function(e){this.users.page=e,this.getGlobalUser()},getGlobalUser:function(){this.users.loading=!0;var e=this,t={page:e.users.page};sessionStorage.getItem(\"token\");l.a.get(n[\"f\"]+\"/api/global/user_list\",{params:t}).then((function(t){e.users.loading=!1,\"999999\"===t.data.code?(e.users.total=t.data.data.total,e.users.pages=t.data.data.pages,e.users.list=[],t.data.data.data.forEach((function(t){e.users.list.push(t)}))):e.$message.error({message:t.data.msg,center:!0})})).catch((function(e){}))},handleUpdate:function(){this.users.visible=!0},selUsersChange:function(e){this.users.selUsers=e},updateUsersSubmit:function(){var e=this,t=this.users.selUsers.map((function(e){return e.id})),a=this;this.$confirm(\"确认更新选中的用户吗？\",\"提示\",{type:\"warning\"}).then((function(){a.users.loading=!0;var s=JSON.stringify({project_id:e.$route.params.project_id,group:a.users.group,ids:t}),r={\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")};l.a.post(n[\"f\"]+\"/api/member/update\",s,{headers:r}).then((function(e){a.users.loading=!1,\"999999\"===e.data.code?a.$message({message:\"更新成功\",center:!0,type:\"success\"}):a.$message.error({message:e.data.msg,center:!0}),a.users.visible=!1,a.getProjectMember()})).catch((function(e){}))})).catch((function(){}))}},mounted:function(){this.getProjectMember(),this.getGlobalUser()}},u=o,g=(a(\"ebba\"),a(\"2877\")),c=Object(g[\"a\"])(u,s,r,!1,null,\"1e6a872a\",null);t[\"default\"]=c.exports},ebba:function(e,t,a){\"use strict\";var s=a(\"1612\"),r=a.n(s);r.a}}]);","extractedComments":[]}