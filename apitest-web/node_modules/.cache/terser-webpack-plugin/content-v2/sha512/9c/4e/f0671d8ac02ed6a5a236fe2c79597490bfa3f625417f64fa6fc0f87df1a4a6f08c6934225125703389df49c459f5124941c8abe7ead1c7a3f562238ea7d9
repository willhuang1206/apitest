{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-3f8707a9\"],{\"3d5a\":function(t,e,i){\"use strict\";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"section\",[i(\"el-col\",{staticClass:\"toolbar\",staticStyle:{\"padding-bottom\":\"0px\"},attrs:{span:24}},[i(\"el-form\",{attrs:{inline:!0,model:t.filters},nativeOn:{submit:function(t){t.preventDefault()}}},[i(\"el-form-item\",[i(\"el-input\",{attrs:{placeholder:\"名称\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.handleSearch(e)}},model:{value:t.filters.name,callback:function(e){t.$set(t.filters,\"name\",\"string\"===typeof e?e.trim():e)},expression:\"filters.name\"}})],1),t._v(\" \"),i(\"el-form-item\",[i(\"el-select\",{attrs:{placeholder:\"类型\"},model:{value:t.filters.type,callback:function(e){t.$set(t.filters,\"type\",e)},expression:\"filters.type\"}},t._l(t.type,(function(t,e){return i(\"el-option\",{attrs:{label:t.label,value:t.value}})})),1)],1),t._v(\" \"),i(\"el-form-item\",[i(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"},on:{click:t.handleSearch}},[t._v(\"查询\")])],1),t._v(\" \"),i(\"el-form-item\",[i(\"router-link\",{staticStyle:{\"text-decoration\":\"none\",color:\"aliceblue\"},attrs:{to:{name:\"新增接口\",params:{project_id:this.$route.params.project_id}}}},[i(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"}},[t._v(\"新增\")])],1)],1),t._v(\" \"),i(\"el-form-item\",[i(\"el-button\",{attrs:{size:\"medium\",type:\"primary\"},on:{click:t.handleImportApi}},[t._v(\"导入\")])],1),t._v(\" \"),i(\"el-form-item\",[i(\"el-button\",{attrs:{size:\"medium\",type:\"primary\",disabled:t.update},on:{click:t.changeGroup}},[t._v(\"修改分组\")])],1)],1)],1),t._v(\" \"),i(\"el-dialog\",{attrs:{width:\"40%\",title:\"修改所属分组\",visible:t.updateGroupFormVisible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.updateGroupFormVisible=e}}},[i(\"el-form\",{ref:\"updateGroupForm\",attrs:{model:t.updateGroupForm,\"label-width\":\"80px\",rules:t.updateGroupFormRules}},[i(\"el-form-item\",{attrs:{label:\"分组名称\",prop:\"firstGroup\"}},[i(\"treeselect\",{attrs:{options:t.group,placeholder:\"请选择\"},model:{value:t.updateGroupForm.firstGroup,callback:function(e){t.$set(t.updateGroupForm,\"firstGroup\",e)},expression:\"updateGroupForm.firstGroup\"}})],1)],1),t._v(\" \"),i(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[i(\"el-button\",{nativeOn:{click:function(e){t.updateGroupFormVisible=!1}}},[t._v(\"取消\")]),t._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",loading:t.updateGroupLoading},nativeOn:{click:function(e){return t.updateGroupSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),i(\"el-dialog\",{attrs:{width:\"40%\",title:\"设置发布项目\",visible:t.updatePublishForm.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.updatePublishForm,\"visible\",e)}}},[i(\"el-form\",{ref:\"updatePublishForm\",attrs:{model:t.updatePublishForm,\"label-width\":\"80px\",rules:t.updatePublishForm.rules}},[i(\"el-form-item\",{attrs:{label:\"发布项目\",prop:\"publish\"}},[i(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:t.updatePublishForm.publish,callback:function(e){t.$set(t.updatePublishForm,\"publish\",e)},expression:\"updatePublishForm.publish\"}},t._l(t.updatePublishForm.publishlist,(function(t,e){return i(\"el-option\",{key:e+\"\",attrs:{label:t,value:t}})})),1)],1)],1),t._v(\" \"),i(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[i(\"el-button\",{nativeOn:{click:function(e){t.updatePublishForm.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",loading:t.updatePublishForm.loading},nativeOn:{click:function(e){return t.updatePublishSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),i(\"el-dialog\",{attrs:{width:\"40%\",title:\"导入接口\",visible:t.importApi.visible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){return t.$set(t.importApi,\"visible\",e)}}},[i(\"el-form\",{attrs:{\"label-width\":\"80px\",rules:t.importApi.rules}},[i(\"el-form-item\",{attrs:{label:\"文件名:\",prop:\"importApi.fileName\"}},[i(\"el-input\",{model:{value:t.importApi.fileName,callback:function(e){t.$set(t.importApi,\"fileName\",\"string\"===typeof e?e.trim():e)},expression:\"importApi.fileName\"}})],1),t._v(\" \"),i(\"el-form-item\",{attrs:{label:\"导入分组:\",prop:\"importApi.toGroup\"}},[i(\"treeselect\",{attrs:{options:t.group,placeholder:\"请选择\"},model:{value:t.importApi.toGroup,callback:function(e){t.$set(t.importApi,\"toGroup\",e)},expression:\"importApi.toGroup\"}})],1),t._v(\" \"),i(\"el-upload\",{staticClass:\"upload-demo\",attrs:{action:t.uploadActionUrl,\"on-success\":t.handleUploadSuccess,limit:1,accept:\".json\",\"file-list\":t.fileList}},[i(\"el-button\",{attrs:{size:\"small\",type:\"primary\"}},[t._v(\"点击上传\")]),t._v(\" \"),i(\"div\",{staticClass:\"el-upload__tip\",attrs:{slot:\"tip\"},slot:\"tip\"},[t._v(\"只能上传并导入json文件\")])],1)],1),t._v(\" \"),i(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[i(\"el-button\",{nativeOn:{click:function(e){t.importApi.visible=!1}}},[t._v(\"取消\")]),t._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\",loading:t.importApi.loading},nativeOn:{click:function(e){return t.importApiSubmit(e)}}},[t._v(\"提交\")])],1)],1),t._v(\" \"),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.api,stripe:\"\",border:\"\",\"element-loading-text\":\"拼命加载中\",\"element-loading-spinner\":\"el-icon-loading\",\"highlight-current-row\":\"\"},on:{\"selection-change\":t.selsChange}},[i(\"el-table-column\",{attrs:{type:\"selection\",\"min-width\":\"4%\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"id\",label:\"ID\",sortable:\"\",\"min-width\":\"8%\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"name\",label:\"名称\",sortable:\"\",\"min-width\":\"14%\",\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[i(\"router-link\",{staticStyle:{\"text-decoration\":\"none\"},attrs:{to:{name:\"基础信息\",params:{api_id:e.row.id}}}},[t._v(t._s(e.row.name))])]}}])}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"type\",label:\"类型\",\"min-width\":\"6%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"apiAddress\",label:\"地址\",\"min-width\":\"20%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"userUpdate\",label:\"更新人\",\"min-width\":\"8%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{prop:\"lastUpdateTime\",label:\"更新日期\",\"min-width\":\"15%\",\"show-overflow-tooltip\":\"\"}}),t._v(\" \"),i(\"el-table-column\",{attrs:{label:\"操作\",\"min-width\":\"15%\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[i(\"el-dropdown\",[i(\"router-link\",{staticStyle:{\"text-decoration\":\"none\",color:\"aliceblue\"},attrs:{to:{name:\"修改接口\",params:{api_id:e.row.id}}}},[i(\"el-button\",{attrs:{type:\"primary\",size:\"small\",plain:\"\"}},[t._v(\"修改\"),i(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})])],1),t._v(\" \"),i(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[i(\"el-dropdown-item\",[i(\"el-button\",{attrs:{type:\"danger\",size:\"small\",plain:\"\"},on:{click:function(i){return t.handleDel(e.$index,e.row)}}},[t._v(\"删除\")])],1)],1)],1)]}}])})],1),t._v(\" \"),i(\"el-col\",{staticClass:\"toolbar\",attrs:{span:24}},[i(\"el-button\",{attrs:{type:\"danger\",disabled:0===this.sels.length},on:{click:t.batchRemove}},[t._v(\"批量删除\")]),t._v(\" \"),i(\"el-pagination\",{staticStyle:{float:\"right\"},attrs:{layout:\"total, prev, pager, next\",\"current-page\":t.page,total:t.total,\"page-size\":t.page_size,\"page-count\":t.pages},on:{\"current-change\":t.handleCurrentChange,\"update:currentPage\":function(e){t.page=e},\"update:current-page\":function(e){t.page=e}}})],1)],1)},a=[],r=(i(\"c5f6\"),i(\"7f7f\"),i(\"ca17\")),s=i.n(r),n=(i(\"542c\"),i(\"4ec3\")),p=i(\"bc3a\"),l=i.n(p),u={components:{Treeselect:s.a},data:function(){return{filters:{name:\"\",type:\"\"},type:[{value:\"\",label:\"\"},{value:\"http\",label:\"普通http\"},{value:\"jyb\",label:\"加油宝app\"},{value:\"service\",label:\"微服务\"}],api:[],total:0,page:1,pages:0,page_size:20,listLoading:!1,sels:[],updateGroupFormVisible:!1,updateGroupForm:{firstGroup:null},updateGroupFormRules:{firstGroup:[{type:\"number\",required:!0,message:\"请选择分组\",trigger:\"blur\"}]},group:[],updateGroupLoading:!1,update:!0,loadSwaggerApi:!1,addLoading:!1,swaggerUrl:\"\",updatePublishForm:{visible:!1,loading:!1,publish:\"\",publishlist:[\"加油宝\",\"资产系统\"],rules:{publish:[{type:\"string\",required:!0,message:\"请选择发布项目\",trigger:\"blur\"}]}},importApi:{type:\"auto\",types:[{value:\"auto\",label:\"auto\"},{value:\"mock.fe\",label:\"mock.fe\"}],visible:!1,loading:!1,rules:{fromGroup:[{type:\"string\",required:!0,message:\"请选择源分组\",trigger:\"blur\"}],toGroup:[{type:\"string\",required:!0,message:\"请选择导入分组\",trigger:\"blur\"}]},value:null,fromGroup:null,toGroup:null,fromDate:\"\",toDate:\"\",groups:[],fileName:\"\"},uploadActionUrl:n[\"f\"]+\"/api/imports/uploadfile\",fileList:[]}},methods:{handleUploadSuccess:function(t,e){this.importApi.fileName=e.name},checkMockStatus:function(t){var e=this,i=JSON.stringify({project_id:Number(this.$route.params.project_id),id:Number(t.id)});l.a.post(n[\"f\"]+\"/api/api/updateMock\",i,{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var i=t.data;e.listLoading=!1,\"999999\"===i.code?(e.$message.success({message:i.msg,center:!0}),e.getApiList()):e.$message.error({message:i.msg,center:!0})})).catch((function(t){}))},handleSearch:function(){this.page=1,this.getApiList()},getApiList:function(){this.listLoading=!0;var t=this;sessionStorage.setItem(\"api_name\",t.filters.name),sessionStorage.setItem(\"api_type\",t.filters.type);var e={project_id:this.$route.params.project_id,page:t.page,name:t.filters.name,type:t.filters.type};this.$route.params.firstGroup&&(e[\"apiGroupLevelFirst_id\"]=this.$route.params.firstGroup),l.a.get(n[\"f\"]+\"/api/api/api_list\",{params:e,headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var i=e.data;t.listLoading=!1,\"999999\"===i.code?(t.total=i.data.total,t.pages=i.data.pages,t.page_size=i.data.page_size,t.api=i.data.data):t.$message.error({message:i.msg,center:!0})})).catch((function(t){}))},getDevApiGroupList:function(){this.importApi.loading=!0;var t=this,e={},i=n[\"f\"]+\"/api/imports/apidomainlist\";\"mock.fe\"==t.importApi.type&&(i=n[\"f\"]+\"/api/imports/devapi_grouplist\"),l.a.get(i,{params:e,headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var i=e.data;t.importApi.loading=!1,\"999999\"===i.code?t.importApi.groups=i.data:t.$message.error({message:i.msg,center:!0})})).catch((function(t){}))},importApiSubmit:function(){var t=this,e=this;this.$confirm(\"确认导入接口吗？\",\"提示\",{type:\"warning\"}).then((function(){t.importApi.loading=!0;var i=JSON.stringify({project_id:Number(t.$route.params.project_id),group_id:t.importApi.toGroup,fileName:t.importApi.fileName}),o=n[\"f\"]+\"/api/imports/api_importfrompostman\";l.a.post(o,i,{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var i=t.data;e.importApi.loading=!1,\"999999\"===i.code?e.$message({message:i.msg,center:!0,type:\"success\"}):e.$message.error({message:i.msg,center:!0}),e.importApi.visible=!1,e.getApiList()})).catch((function(t){}))})).catch((function(){}))},updateGroupSubmit:function(){var t=this,e=this.sels.map((function(t){return t.id})),i=this;this.$confirm(\"确认修改所属分组吗？\",\"提示\",{type:\"warning\"}).then((function(){i.updateGroupLoading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),apiGroupLevelFirst_id:Number(i.updateGroupForm.firstGroup),ids:e});l.a.post(n[\"f\"]+\"/api/api/update_group\",o,{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var e=t.data;i.updateGroupLoading=!1,\"999999\"===e.code?(i.$message({message:\"修改成功\",center:!0,type:\"success\"}),i.$router.push({name:\"分组接口列表\",params:{project_id:i.$route.params.project_id,firstGroup:i.updateGroupForm.firstGroup}})):i.$message.error({message:e.msg,center:!0}),i.updateGroupFormVisible=!1,i.getApiList()})).catch((function(t){}))})).catch((function(){}))},updatePublishSubmit:function(){var t=this,e=this.sels.map((function(t){return t.id})),i=this;this.$confirm(\"确认修改发布项目吗？\",\"提示\",{type:\"warning\"}).then((function(){i.updatePublishForm.loading=!0;var o=JSON.stringify({project_id:Number(t.$route.params.project_id),publish:i.updatePublishForm.publish,ids:e});l.a.post(n[\"f\"]+\"/api/api/update_publish\",o,{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var e=t.data;i.updatePublishForm.loading=!1,\"999999\"===e.code?i.$message({message:\"修改成功\",center:!0,type:\"success\"}):i.$message.error({message:e.msg,center:!0}),i.updatePublishForm.visible=!1,i.getApiList()})).catch((function(t){}))})).catch((function(){}))},getApiGroup:function(){var t=this;l.a.get(n[\"f\"]+\"/api/api/group\",{params:{project_id:this.$route.params.project_id},headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var i=e.data;\"999999\"===i.code?t.group=i.data:t.$message.error({message:i.msg,center:!0})})).catch((function(t){}))},changeGroup:function(){this.getApiGroup(),this.updateGroupFormVisible=!0},changePublish:function(){this.updatePublishForm.visible=!0},handleImportApi:function(){this.getApiGroup(),this.getDevApiGroupList(),this.importApi.visible=!0},handleDel:function(t,e){var i=this;this.$confirm(\"确认删除接口[\"+e.name+\"]吗?\",\"提示\",{type:\"warning\"}).then((function(){i.listLoading=!0;var t=i;l.a.post(n[\"f\"]+\"/api/api/del_api\",JSON.stringify({project_id:Number(i.$route.params.project_id),ids:[e.id]}),{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var i=e.data;\"999999\"===i.code?t.$message({message:\"删除成功\",center:!0,type:\"success\"}):t.$message.error({message:i.msg,center:!0}),t.getApiList()})).catch((function(t){}))})).catch((function(){}))},DownloadApi:function(){l.a.get(n[\"f\"]+\"/api/api/Download\",{params:{project_id:this.$route.params.project_id},headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var e=t.data;\"999999\"===e.code&&window.open(n[\"f\"]+\"/api/api/download_doc?url=\"+e.data)})).catch((function(t){}))},handleCurrentChange:function(t){this.page=t,this.getApiList()},selsChange:function(t){t.length>0?(this.sels=t,this.update=!1):this.update=!0},batchRemove:function(){var t=this,e=this.sels.map((function(t){return t.id})),i=this;this.$confirm(\"确认删除选中记录吗？\",\"提示\",{type:\"warning\"}).then((function(){i.listLoading=!0,l.a.post(n[\"f\"]+\"/api/api/del_api\",JSON.stringify({project_id:Number(t.$route.params.project_id),ids:e}),{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(t){var e=t.data;i.listLoading=!1,\"999999\"===e.code?i.$message({message:\"删除成功\",center:!0,type:\"success\"}):i.$message.error({message:e.msg,center:!0}),i.getApiList()})).catch((function(t){}))})).catch((function(){}))},addSubmit:function(){var t=this;this.addLoading=!0,console.log(this.swaggerUrl),this.swaggerUrl?l.a.post(n[\"f\"]+\"/api/api/lead_swagger\",JSON.stringify({project_id:Number(this.$route.params.project_id),url:this.swaggerUrl}),{headers:{\"Content-Type\":\"application/json\",Authorization:\"Token \"+sessionStorage.getItem(\"token\")}}).then((function(e){var i=e.data;\"999999\"===i.code?(t.$message({message:\"添加成功\",center:!0,type:\"success\"}),t.listLoading=!0,t.addLoading=!1,t.loadSwaggerApi=!1,t.getApiList()):(t.addLoading=!1,t.$message.error({message:\"导入失败，请检查地址是否正确\",center:!0})),t.getApiList()})).catch((function(t){})):this.addLoading=!1},load:function(){null!=sessionStorage.getItem(\"api_name\")&&(this.filters.name=sessionStorage.getItem(\"api_name\")),null!=sessionStorage.getItem(\"api_type\")&&(this.filters.type=sessionStorage.getItem(\"api_type\")),this.getApiList(),this.$route.params.firstGroup&&(this.updateGroupForm.firstGroup=Number(this.$route.params.firstGroup),this.importApi.toGroup=Number(this.$route.params.firstGroup),sessionStorage.setItem(\"api_group\",this.$route.params.firstGroup))}},mounted:function(){this.load()},watch:{$route:function(t,e){t.query!=e.query&&this.load()}}},c=u,d=(i(\"d734\"),i(\"2877\")),m=Object(d[\"a\"])(c,o,a,!1,null,\"0300abc8\",null);e[\"default\"]=m.exports},d566:function(t,e,i){},d734:function(t,e,i){\"use strict\";var o=i(\"d566\"),a=i.n(o);a.a}}]);","extractedComments":[]}