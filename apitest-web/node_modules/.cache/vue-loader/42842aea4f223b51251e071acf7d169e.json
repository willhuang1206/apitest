{"remainingRequest":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangrong/workspace/apitest/apitest-web/src/views/project/api/api.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangrong/workspace/apitest/apitest-web/src/views/project/api/api.vue","mtime":1590475887872},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangrong/workspace/apitest/apitest-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { test } from '@/api/api'\nimport axios from 'axios';\nimport NavMenu from \"@/components/navMenu.vue\";\nexport default {\n    components: {\n      NavMenu\n    },\n    data() {\n        return {\n            project: \"\",\n            groupData: [],\n            GroupForm:{\n                title: '',\n                visible: false,\n                loading: false,\n                rules: {\n                    name: [\n                        { required: true, message: '请输入分组名称', trigger: 'blur' },\n                    ]\n                },\n                //新增界面数据\n                data: {\n                    name: '',\n                    id: '',\n                    parentId: '',\n                },\n            },\n            filters: {\n                name: ''\n            },\n            api: [],\n            total: 0,\n            page: 1,\n            listLoading: false,\n            sels: [],//列表选中列\n            apiView: true,\n        }\n    },\n    methods: {\n        // 获取api分组\n        getApiGroup() {\n            let self = this;\n            let params = {\n                project_id: this.$route.params.project_id\n            };\n            let headers = {\n                \"Content-Type\": \"application/json\",\n                Authorization: 'Token '+sessionStorage.getItem('token')\n            };\n            axios.get(`${test}/api/api/group`, { params: params, headers:headers}).then(res => {\n                let {msg, code, data} = res.data;\n                if (code === '999999') {\n                    self.groupData = data;\n                }\n                else {\n                    self.$message.error({\n                        message: msg,\n                        center: true,\n                    })\n                }\n            })\n        },\n        // 添加分组弹窗显示\n        handleAddGroup(groupId) {\n            this.GroupForm.visible = true;\n            this.GroupForm.title=\"新增分组\";\n            this.GroupForm.data={\n                    name: '',\n                    id: '',\n                    parentId: groupId,\n                };\n            if(groupId){\n                this.GroupForm.data.parentId=groupId;\n            }\n        },\n        // 修改分组弹窗显示\n        handleEditGroup(groupId, name) {\n            this.GroupForm.visible = true;\n            this.GroupForm.title=\"修改分组\";\n            this.GroupForm.data.id = groupId;\n            this.GroupForm.data={\n                    name: name,\n                    id: groupId,\n                    parentId: '',\n                };\n        },\n        //删除分组\n        handleDelGroup: function (id) {\n            this.$confirm('确认删除该分组吗?', '提示', {\n                type: 'warning'\n            }).then(() => {\n                //NProgress.start();\n                let self = this;\n                let params = {\n                    id: Number(id),\n                    project_id: Number(this.$route.params.project_id)\n                };\n                let headers = {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: 'Token ' + sessionStorage.getItem('token')\n                };\n                axios.post(`${test}/api/api/del_group`, params, {headers}).then(res => {\n                    let {msg, code, data} = res.data;\n                    if (code === '999999') {\n                        self.$message({\n                            message: '删除成功',\n                            center: true,\n                            type: 'success'\n                        })\n                    } else {\n                        self.$message.error({\n                            message: msg,\n                            center: true,\n                        })\n                    }\n                    self.getApiGroup()\n                })\n            }).catch(() => {});\n        },\n        // 添加分组\n        GroupFormSubmit() {\n            this.$refs.GroupForm.validate((valid) => {\n                if (valid) {\n                    let self = this;\n                    this.$confirm('确认提交吗？', '提示', {}).then(() => {\n                        self.GroupForm.loading = true;\n                        //NProgress.start();\n                        let params = {\n                            project_id: Number(this.$route.params.project_id),\n                            name: self.GroupForm.data.name\n                        };\n                        let url='';\n                        if(self.GroupForm.data.id!=''){\n                            url=`${test}/api/api/update_name_group`;\n                            params[\"id\"]=self.GroupForm.data.id;\n                        }else{\n                            url=`${test}/api/api/add_group`;\n                            params[\"parent_id\"]=self.GroupForm.data.parentId;\n                        }\n                        let headers = {\n                            \"Content-Type\": \"application/json\",\n                            Authorization: 'Token '+sessionStorage.getItem('token')\n                        };\n                        axios.post(url, params, {headers}).then(res => {\n                            let {msg, code, data} = res.data;\n                            self.GroupForm.loading = false;\n                            if (code === '999999') {\n                                self.$message({\n                                    message: '执行成功',\n                                    center: true,\n                                    type: 'success'\n                                });\n                                self.$refs['GroupForm'].resetFields();\n                                self.GroupForm.visible = false;\n                                self.getApiGroup();\n                            } else if (code === '999997'){\n                                self.$message.error({\n                                    message: msg,\n                                    center: true,\n                                })\n                            } else {\n                                self.$message.error({\n                                    message: msg,\n                                    center: true,\n                                });\n                                self.$refs['GroupForm'].resetFields();\n                                self.GroupForm.visible = false;\n                                self.getApiGroup();\n                            }\n                        })\n                    }).catch(() => {});\n                }\n            });\n        },\n    },\n    mounted() {\n        this.getApiGroup();\n        this.project = this.$route.params.project_id\n\n    }\n}\n\n",null]}